<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Github之SSH连接配置]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Git/Github%E4%B9%8BSSH%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>虽然github推荐使用https方式进行连接，但是ssh方式咱们也得会，官网上也都有详细的<a href="https://help.github.com/articles/testing-your-ssh-connection/" target="_blank" rel="noopener">文档介绍</a>，步骤比较简单，记录这篇的目的是给初入门的小伙伴多一个学习的门径，同时也方便日后自己查看。</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a><strong>前言</strong></h2><p>在没有配置ssh的情况下使用ssh连接操作github库的时候会出现如下异常：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git@github.com:linmuxi/test-git.git</span><br><span class="line">Cloning into &apos;test-git&apos;...</span><br><span class="line">Warning: Permanently added the RSA host key for IP address &apos;192.30.252.129&apos; to the list of known hosts.</span><br><span class="line">Permission denied (publickey).</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br><span class="line">~</span><br></pre></td></tr></table></figure>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a><strong>步骤</strong></h2><blockquote>
<p>前提是我们已经新建好了一个库test-git,ssh路径是：<a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:linmuxi/test-git.git</p>
</blockquote>
<h3 id="1、检查ssh-keys是否存在"><a href="#1、检查ssh-keys是否存在" class="headerlink" title="1、检查ssh keys是否存在"></a><strong>1、检查ssh keys是否存在</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -al ~/.ssh</span><br></pre></td></tr></table></figure>
<p>如果目录下面没有id_rsa、id_rsa.pub则表示key不存在</p>
<h3 id="2、生成ssh-key"><a href="#2、生成ssh-key" class="headerlink" title="2、生成ssh key"></a><strong>2、生成ssh key</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/c/Users/Hunter/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in /c/Users/Hunter/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /c/Users/Hunter/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:7KwlOZ4yljBZE2ZJ7dr8QGIyQeiPk49L+01fnC0hAZY your_email@example.com</span><br><span class="line">The key&apos;s randomart image is:</span><br><span class="line">+---[RSA 4096]----+</span><br><span class="line">| o...=.          |</span><br><span class="line">|. . *Eo          |</span><br><span class="line">|.  + o .         |</span><br><span class="line">| .o = o..        |</span><br><span class="line">|  +* B .S.       |</span><br><span class="line">| ++.. ++o +      |</span><br><span class="line">| .+o o+o+= .     |</span><br><span class="line">|....B..*o .      |</span><br><span class="line">| ooo ++.         |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure>
<h3 id="3、将ssh-key添加到ssh-agent"><a href="#3、将ssh-key添加到ssh-agent" class="headerlink" title="3、将ssh key添加到ssh-agent"></a><strong>3、将ssh key添加到ssh-agent</strong></h3><p>先确认ssh-agent是可用的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ eval $(ssh-agent -s)</span><br><span class="line">Agent pid 20632</span><br></pre></td></tr></table></figure>
<p>将ssh key添加到ssh-agent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-add ~/.ssh/id_rsa</span><br><span class="line">Identity added: /c/Users/Hunter/.ssh/id_rsa (/c/Users/Hunter/.ssh/id_rsa)</span><br></pre></td></tr></table></figure>
<h3 id="4、将ssh-key配置到github"><a href="#4、将ssh-key配置到github" class="headerlink" title="4、将ssh key配置到github"></a><strong>4、将ssh key配置到github</strong></h3><p>复制key内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ clip &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>配置key到github<br>登录github-&gt;选择Settings-&gt;SSH keys-&gt;New SSH key</p>
<p>测试ssh key的配置情况</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -t git@github.com</span><br><span class="line">Warning: Permanently added the RSA host key for IP address &apos;192.30.252.128&apos; to the list of known hosts.</span><br><span class="line">PTY allocation request failed on channel 0</span><br></pre></td></tr></table></figure>
<p>到这里就配置好了</p>
<p>再次执行clone操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git@github.com:linmuxi/test-git.git</span><br><span class="line">Cloning into &apos;test-git&apos;...</span><br><span class="line">remote: Counting objects: 56, done.</span><br><span class="line">remote: Compressing objects: 100% (34/34), done.</span><br><span class="line">remote: Total 56 (delta 4), reused 0 (delta 0), pack-reused 8</span><br><span class="line">Receiving objects: 100% (56/56), 5.42 KiB | 0 bytes/s, done.</span><br><span class="line">Resolving deltas: 100% (4/4), done.</span><br><span class="line">Checking connectivity... done.</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Git </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Git </tag>
            
            <tag> GitHub </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[艾旦影视华人自自己的电影网站]]></title>
      <url>https://github.jiangnan.pw/%E4%BD%9C%E5%93%81%E5%B1%95%E7%A4%BA/%E8%89%BE%E6%97%A6%E5%BD%B1%E8%A7%86%E5%8D%8E%E4%BA%BA%E8%87%AA%E8%87%AA%E5%B7%B1%E7%9A%84%E7%94%B5%E5%BD%B1%E7%BD%91%E7%AB%99/</url>
      <content type="html"><![CDATA[<h1 id="艾旦影视"><a href="#艾旦影视" class="headerlink" title="艾旦影视"></a>艾旦影视</h1><h2 id="江南品位旗下网站，江南品位，品味人生。"><a href="#江南品位旗下网站，江南品位，品味人生。" class="headerlink" title="江南品位旗下网站，江南品位，品味人生。"></a>江南品位旗下网站，江南品位，品味人生。</h2><p><img src="http://upload-images.jianshu.io/upload_images/4408654-fef9fa2636455603?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="首页"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-3ec4bd854217b151?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="综艺"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-0072f2dbf448db37?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="电视剧"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-df50a49beff50553?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="电视直播"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-b3045e18467ae3e9?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="电影"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-d0351a1462ce825c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="动作频道  "></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4408654-f1c338820a235373?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="动漫"></p>
<p>艾旦影视，致力于为海外华人提供影音，娱乐资讯等服务的综合性娱乐网站。为全球华人更新海量高清在线视频影视资源,手机在线播放迅雷下载,  2019最新好看的电影,电视剧,综艺节目,动漫推荐,解决海外版权播放限制, 全球海外华人影视站。  </p>
<p>为海外华人提供</p>
<ol>
<li><p>在线网络电视。</p>
</li>
<li><p>全网VIP视频免费解析。</p>
</li>
<li><p>高清院线电影电视剧，免费在线观看。</p>
</li>
<li><p>免费音乐在线播放，下载。</p>
</li>
<li><p>最新娱乐资讯推送</p>
</li>
</ol>
<p>网站成立于2012，一直秉承着用户就是上帝的运营理念，不断满足广大海外华人日益增长的观赏水平，但本站承诺绝不以任何形式收取费用，永久为广大华人提供优质及时的观影服务。艾旦影视是海外华人专属的中文视频网站，独家开发全网搜索以及国内视频解锁功能，支持国内主流视频在线观看，为海外用户提供清晰、流畅、界面友好的观映体验。网站还具有海外新闻资讯，以视频形式供海外人士了解身边实事，同时它也是海外视频网站的主宰。</p>
<p>本站现有栏目及影片数量：</p>
<p>1.<a href="https://www.lovedan.net/frim/index1.html" target="_blank" rel="noopener">电影</a>(15801)<br>5.<a href="https://www.lovedan.net/frim/index5.html" target="_blank" rel="noopener">动作片</a>(2625)<br>6.<a href="https://www.lovedan.net/frim/index6.html" target="_blank" rel="noopener">爱情片</a>(1430)<br>7.<a href="https://www.lovedan.net/frim/index7.html" target="_blank" rel="noopener">科幻片</a>(774)<br>8.<a href="https://www.lovedan.net/frim/index8.html" target="_blank" rel="noopener">恐怖片</a>(1543)<br>9.<a href="https://www.lovedan.net/frim/index9.html" target="_blank" rel="noopener">战争片</a>(233)<br>10.<a href="https://www.lovedan.net/frim/index10.html" target="_blank" rel="noopener">喜剧片</a>(2956)<br>11.<a href="https://www.lovedan.net/frim/index11.html" target="_blank" rel="noopener">纪录片</a>(250)<br>12.<a href="https://www.lovedan.net/frim/index12.html" target="_blank" rel="noopener">剧情片</a>(5990)<br>2.<a href="https://www.lovedan.net/frim/index2.html" target="_blank" rel="noopener">电视剧</a>(6518)<br>13.<a href="https://www.lovedan.net/frim/index13.html" target="_blank" rel="noopener">大陆剧</a>(1753)<br>14.<a href="https://www.lovedan.net/frim/index14.html" target="_blank" rel="noopener">港台剧</a>(849)<br>15.<a href="https://www.lovedan.net/frim/index15.html" target="_blank" rel="noopener">欧美剧</a>(2516)<br>16.<a href="https://www.lovedan.net/frim/index16.html" target="_blank" rel="noopener">日韩剧</a>(1140)<br>28.<a href="https://www.lovedan.net/frim/index28.html" target="_blank" rel="noopener">泰剧</a>(257)<br>3.<a href="https://www.lovedan.net/frim/index3.html" target="_blank" rel="noopener">综艺</a>(1156)<br>4.<a href="https://www.lovedan.net/frim/index4.html" target="_blank" rel="noopener">动漫</a>(2334)</p>
<p>而且每天都在稳定增加，欢迎广大海外华人踊跃留言告诉我们你们想法，建议。有你们的支持我们会做的更好。</p>
<p><a href="http://movie.lovedan.net/" target="_blank" rel="noopener">海外影院</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">海外yy</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">在国外怎么看国内视频</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">在国外怎么看优酷</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">国外看爱奇艺</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">国外看电视剧</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">国外看电影</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">国外看美剧</a>,<a href="http://movie.lovedan.net/" target="_blank" rel="noopener">海外看视频</a></p>
<p><a href="http://movie.lovedan.net/gbook.php" target="_blank" rel="noopener">求片留言</a> <a href="http://movie.lovedan.net/" target="_blank" rel="noopener">首页</a> <a href="http://movie.lovedan.net/frim/index1.html" target="_blank" rel="noopener">电影</a> <a href="http://movie.lovedan.net/frim/index2.html" target="_blank" rel="noopener">电视剧</a> <a href="http://movie.lovedan.net/frim/index3.html" target="_blank" rel="noopener">综艺</a> <a href="http://movie.lovedan.net/frim/index4.html" target="_blank" rel="noopener">动漫</a> <a href="http://movie.lovedan.net/frim/index5.html" target="_blank" rel="noopener">动作片</a> <a href="http://movie.lovedan.net/live" target="_blank" rel="noopener">电视直播</a> <a href="http://movie.lovedan.net/jiexi" target="_blank" rel="noopener">VIP电影观看</a> <a href="http://movie.lovedan.net/rank" target="_blank" rel="noopener">最新排行</a> <a href="http://movie.lovedan.net/faq" target="_blank" rel="noopener">播放帮助</a></p>
<p>求片留言：<a href="https://www.lovedan.net/gbook.php" target="_blank" rel="noopener">https://www.lovedan.net/gbook.php</a></p>
<p>电视直播：<a href="https://www.lovedan.net/live" target="_blank" rel="noopener">https://www.lovedan.net/live</a></p>
<p>VIP视频解析：<a href="https://www.lovedan.net/vip" target="_blank" rel="noopener">https://www.lovedan.net/vip</a></p>
<p>电影：<a href="https://www.lovedan.net/index1.html" target="_blank" rel="noopener">https://www.lovedan.net/list/index1.html</a></p>
<p>电视剧：<a href="https://www.lovedan.net/index2.html" target="_blank" rel="noopener">https://www.lovedan.net/list/index2.html</a></p>
<p>综艺：<a href="https://www.lovedan.net/index3.html" target="_blank" rel="noopener">https://www.lovedan.net/list/index3.html</a></p>
<p>动漫：<a href="https://www.lovedan.net/index4.html" target="_blank" rel="noopener">https://www.lovedan.net/list/index4.html</a></p>
<p>在海外看视频就选艾旦影视，希望转发朋友圈支持一下。</p>
<p>地址 <a href="https://www.lovedan.net" target="_blank" rel="noopener">https://www.lovedan.net</a></p>
]]></content>
      
        <categories>
            
            <category> 作品展示 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 作品展示 </tag>
            
            <tag> 艾旦影视 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Profile Builder to add support for PolyLang plugin in field titles]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/WordPress/Profile%20Builder%20support%20PolyLang/</url>
      <content type="html"><![CDATA[<p>Shortcode to add support for PolyLang plugin in field titles, descriptions and labels.</p>
<p><strong>Make sure to:</strong></p>
<ul>
<li>Change Label name in Manage Fields (<strong>click image</strong>):</li>
</ul>
<p><a href><img src="https://lh3.googleusercontent.com/-VHCXjHsliLE/Wb6x_rST8XI/AAAAAAAADec/yogRDcV_MK0EPKralcNt9GXjNywID8QFQCHMYCw/I/1-300x91.png" alt="1"></a></p>
<p>Label name must be (for English and Francais):</p>
<p>UsernameNom d’utilizateur</p>
<p>You can add as many languages as you need.</p>
<p>You must translate each field like in the e.g. above.</p>
<ul>
<li>Add shortcode at the top of your page:</li>
</ul>
<p><strong>[wppb_polylang_compat]</strong></p>
<p>Now when you change language with Language Switcher the fields language will change.</p>
<p>This is more like a hack to make it work.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Shortcode to add support for PolyLang plugin in field titles, descriptions and labels.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">add_shortcode(&apos;wppb_polylang_compat&apos;, &apos;wppb_polylang_compat&apos;);</span><br><span class="line">function wppb_polylang_compat($atts,$content=null)&#123;</span><br><span class="line">   return &quot;</span><br><span class="line">      jQuery(document).ready(function()&#123;</span><br><span class="line">         curr_lang = jQuery(&apos;html&apos;)[0].lang;</span><br><span class="line">         jQuery(&apos;.wppb-user-forms li label &gt; span, .wppb-user-forms li .wppb-description-delimiter &gt; span&apos;).each(function(element)&#123;</span><br><span class="line">            jQuery(this).hide();</span><br><span class="line">            if ( jQuery(this).attr(&apos;lang&apos;) == curr_lang )&#123;</span><br><span class="line">               jQuery(this).show();</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">   &quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> WordPress </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> plugins </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[visual studio code（vscode）调试php]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E8%BD%AF%E4%BB%B6/visual%20studio%20code%EF%BC%88vscode%EF%BC%89%E8%B0%83%E8%AF%95php/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>1.下载vscode (<a href="https://www.visualstudio.com/" target="_blank" rel="noopener">visual studio code</a>)。</p>
<p>2.安装vscode 扩展 php-debug 安装步骤见 <a href="https://marketplace.visualstudio.com/items?itemName=felixfbecker.php-debug。" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=felixfbecker.php-debug。</a></p>
<p>3.安装wampserver,我安装的是2.5 版本，安装步骤自行百度。</p>
<p>4.确保apache的80 端口未占用，如果占用了修改httpd.conf 配置文件下的端口号</p>
<p>5.修改php.ini（wamp\bin\apache\apache2.4.9\bin 这个文件夹下的） 文件开启debug，</p>
<p>修改以下两项：</p>
<p>xdebug.remote_enable = on</p>
<p>xdebug.remote_autostart=on</p>
<p>6.如果vscode 报这个<img src="https://lh3.googleusercontent.com/-Esav1O51PeE/Wa36WFVWIUI/AAAAAAAADcM/OnkMHQkNFog_LndPMSF-W5LT2ly5XPpmgCHMYCw/I/284201-20160314155819521-1359852711.png" alt></p>
<p>修改用户配置<img src="https://lh3.googleusercontent.com/-f7ZC2KSNy9U/Wa36WQQ6wLI/AAAAAAAADcQ/Us2JKD5ToP0o8DDxISl6NluvI9sNeAr0gCHMYCw/I/284201-20160314155836381-404314791.png" alt></p>
<p><img src="https://lh3.googleusercontent.com/-g9cD6Pdp-W8/Wa36WlS1upI/AAAAAAAADcU/ghJhtkYU_okjLT7beWDDcWgQReGvh67qACHMYCw/I/284201-20160314160038474-30091765.png" alt></p>
<p>7.配置debug</p>
<p><img src="https://lh3.googleusercontent.com/-yH-r7YX1MYo/Wa36W9scymI/AAAAAAAADcY/Kv4FT96AQlI0yz-UH2gFP9EGEbmOeb4bwCHMYCw/I/284201-20160314160221240-268065764.png" alt></p>
<p>选择listen for xdebug</p>
<p><img src="https://lh3.googleusercontent.com/-qKWaE8AZqN8/Wa36XMSuMaI/AAAAAAAADcc/hJ_406dfl1EgZu9FfzZdk95y_sYvmzSiwCHMYCw/I/284201-20160314160322303-2072419759.png" alt></p>
<p>8.启动wampserver</p>
<p>9.在需要的地方打上断点 F5 启动，在浏览器里输入地址，vscode 自动会停在断点处</p>
<p><img src="https://lh3.googleusercontent.com/-C5V_QFRHE68/Wa36Xuv0acI/AAAAAAAADcg/WgB_JEfyzRsIfLVr1chqfK7cVGAur9ttwCHMYCw/I/284201-20160314160930990-363539015.png" alt></p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac软件 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac软件 </tag>
            
            <tag> vscode </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Postfixでローカルメール以外をSMTP認証サーバやGMAILにリレーするための設定を記載します]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/Postfix%E3%81%A7%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%83%A1%E3%83%BC%E3%83%AB%E4%BB%A5%E5%A4%96%E3%82%92SMTP%E8%AA%8D%E8%A8%BC%E3%82%B5%E3%83%BC%E3%83%90/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>リレー先メールサーバがSMTP認証しか受け付けないだとか、TLS/SSLだったりとかで設定がいろいろ変わります</p>
<p>ここではそれぞれのケースに応じた設定を記載していきます</p>
<h2 id="SMTP認証のない相手へのリレー設定"><a href="#SMTP認証のない相手へのリレー設定" class="headerlink" title="SMTP認証のない相手へのリレー設定"></a>SMTP認証のない相手へのリレー設定</h2><p>リレー先メールサーバが特に認証がない場合は設定は簡単です</p>
<p>Postfix設定ファイル(/etc/postfix.main.cf)に以下を設定するだけです<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">relayhost = [SMTPホスト]:ポート番号</span><br><span class="line">relayhost = [IPアドレス]:ポート番号</span><br><span class="line">relayhost = SMTPホスト名:ポート番号</span><br></pre></td></tr></table></figure></p>
<p>ポート番号は25番や587(サブミッションポート)が一般的です<br>[]で囲むとMX検索しません<br>Postfixをリロードして設定を有効にします<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/postfix reload</span><br></pre></td></tr></table></figure></p>
<p>リレー先メールサーバにSMTP Auth(SMTP認証)が必要な場合</p>
<h2 id="自身のメールサーバをSMTPクライアントしてリレーサーバにメールをリレーする様に設定します"><a href="#自身のメールサーバをSMTPクライアントしてリレーサーバにメールをリレーする様に設定します" class="headerlink" title="自身のメールサーバをSMTPクライアントしてリレーサーバにメールをリレーする様に設定します"></a>自身のメールサーバをSMTPクライアントしてリレーサーバにメールをリレーする様に設定します</h2><p>Postfix設定ファイル(/etc/postfix.main.cf)に以下を設定します<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">relayhost = [SMTPホスト]:ポート番号</span><br><span class="line">smtp_sasl_auth_enable = yes</span><br><span class="line">smtp_sasl_password_maps = hash:/etc/postfix/relay_password</span><br><span class="line">smtp_sasl_security_options = noanonymous</span><br></pre></td></tr></table></figure></p>
<ul>
<li>relaygostはリレー先サーバの情報を設定します</li>
<li>smtp_sasl_password_mapsで、SMTP認証情報を記述したファイルを指定します(後述)</li>
<li>smtp_sasl_security_optionsの規定値は 「noplaintext, noanonymous」です<br>続いてSMTP認証情報を記述したファイルを作成します</li>
</ul>
<p>作成するファイルは、/etc/posfix/relay_passwordです<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[SMTPホスト名]:ポート番号   SMTP認証ユーザ名:SMTP認証パスワード</span><br><span class="line">   :       :     :</span><br><span class="line">   :       :     :</span><br></pre></td></tr></table></figure></p>
<ul>
<li>SMTP認証情報をホスト毎に1行ずつ記載します</li>
<li>[]で囲むとMX検索しません</li>
<li>/etc/posfix/relay_passwordはパスワードが丸見えなのでパーミッションを変更(600)してrootしか読めないようにしておきましょう<br>ファイル作成後は、postmapコマンドでデータベース化し、/etc/postfix/relay_password.db を作成します<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postmap hash:/etc/postfix/relay_password</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Postfixをリロードして設定を有効にして完了です<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/postfix reload</span><br></pre></td></tr></table></figure></p>
<h2 id="GMAILをリレーサーバにする場合"><a href="#GMAILをリレーサーバにする場合" class="headerlink" title="GMAILをリレーサーバにする場合"></a>GMAILをリレーサーバにする場合</h2><p>GmailのようなTLS/SSLなメールサーバにリレーする為には少し設定が多くなります</p>
<h3 id="パッケージのインストール"><a href="#パッケージのインストール" class="headerlink" title="パッケージのインストール"></a>パッケージのインストール</h3><p>処理に必要となるcyrusパッケージ群をインストールします<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install cyrus-*</span><br></pre></td></tr></table></figure></p>
<h3 id="Postfixの設定"><a href="#Postfixの設定" class="headerlink" title="Postfixの設定"></a>Postfixの設定</h3><p>Postfix設定ファイル(/etc/postfix.main.cf)に以下を設定します<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">relayhost = [smtp.gmail.com]:587</span><br><span class="line">smtp_use_tls = yes</span><br><span class="line">smtp_sasl_auth_enable = yes</span><br><span class="line">smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd</span><br><span class="line">smtp_sasl_tls_security_options = noanonymous</span><br><span class="line">smtp_sasl_mechanism_filter = plain</span><br><span class="line">smtp_tls_CApath = /etc/pki/tls/certs/ca-bundle.crt</span><br></pre></td></tr></table></figure></p>
<p>続いてGMAIL認証情報を記述したファイルを作成します</p>
<p>作成するファイルは、/etc/posfix/sasl_passwordです<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smtp.gmail.com]:587   GMAILメールアドレス:パスワード</span><br></pre></td></tr></table></figure></p>
<p>ファイル作成後は、postmapコマンドでデータベース化し、/etc/postfix/sasl_password.db を作成します<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postmap hash:/etc/postfix/relay_password</span><br></pre></td></tr></table></figure></p>
<p>Postfixをリロードして設定を有効にして完了です<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/postfix reload</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
            <tag> php </tag>
            
            <tag> mail </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SEND MAIL() USING PHP ON MAC OS X]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/SEND%20MAIL()%20USING%20PHP%20ON%20MAC%20OS%20X/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>Thanks to Benjamin Rojas, Andy Stratton, and a tip from Jasper, I was able to successfully send email from my home-brewed MAMP environment. Here’s the summary.</p>
<ol>
<li>Add the following to your /etc/postfix/sasl_passwd file:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smtp.gmail.com:587 username@gmail.com:password</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>(Of course, you don’t have to use GMail or port 587, but you get the idea.)</p>
<ol start="2">
<li>Configure postfix:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo postmap /etc/postfix/sasl_passwd</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Backup and edit your postfix configuration:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/postfix/main.cf /etc/postfix/main.cf.orig</span><br><span class="line">sudo vim /etc/postfix/main.cf</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>If you use TLS, then you will need to add the TLS settings but the other settings should already be there as a result of running the postmap command. You should have these options set in /etc/postfix/main.cf:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mydomain_fallback = localhost</span><br><span class="line">mail_owner = _postfix</span><br><span class="line">setgid_group = _postdrop</span><br><span class="line">relayhost=smtp.gmail.com:587</span><br><span class="line">smtp_sasl_auth_enable=yes</span><br><span class="line">smtp_sasl_password_maps=hash:/etc/postfix/sasl_passwd</span><br><span class="line">smtp_sasl_security_options=</span><br><span class="line">smtp_use_tls=yes</span><br><span class="line">smtp_tls_security_level=encrypt</span><br><span class="line">tls_random_source=dev:/dev/urandom</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Start postfix:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo postfix start</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>If there are errors, you may need to edit your /etc/postfix/main.cf and restart postfix:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo postfix reload</span><br></pre></td></tr></table></figure></p>
<ol start="5">
<li><p>Send a test message:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date | mail -s test youremailaddress@yourdomain.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>Make postfix start automatically on boot by opening your /System/Library/LaunchDaemons/org.postfix.master.plist file and adding:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;RunAtLoad&lt;/key&gt;</span><br><span class="line">&lt;true/&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Add this at the bottom just before the closing  tag.</p>
<ol start="7">
<li>Edit your /etc/php.ini file and configure the sendmail_path option:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendmail_path = &quot;sendmail -t -i&quot;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>You should now be able to send email using PHP’s mail() function. If you continue to have issues, watch the contents of your postfix mail log:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f /var/log/mail.log</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
            <tag> php </tag>
            
            <tag> mail </tag>
            
            <tag> postfix </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[导入数据库时报错1067–Invalid default value for ‘字段名’]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/MySql/%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%97%B6%E6%8A%A5%E9%94%991067/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>最近把mysql升级到5.7了，wordpress导数据报错</p>
<p>Invalid default value for ‘comment_date’</p>
<p>原因出在类似这样的语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS `wp_comments`; CREATE TABLE `wp_comments`  (</span><br><span class="line">  `comment_ID` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `comment_post_ID` bigint(20) UNSIGNED NOT NULL DEFAULT 0,</span><br><span class="line">  `comment_author` tinytext CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL,</span><br><span class="line">  `comment_author_email` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `comment_author_url` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `comment_author_IP` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `comment_date` datetime(0) NOT NULL DEFAULT &apos;0000-00-00 00:00:00&apos;,</span><br><span class="line">  `comment_date_gmt` datetime(0) NOT NULL DEFAULT &apos;0000-00-00 00:00:00&apos;,</span><br><span class="line">  `comment_content` text CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL,</span><br><span class="line">  `comment_karma` int(11) NOT NULL DEFAULT 0,</span><br><span class="line">  `comment_approved` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;1&apos;,</span><br><span class="line">  `comment_agent` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `comment_type` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_520_ci NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `comment_parent` bigint(20) UNSIGNED NOT NULL DEFAULT 0,</span><br><span class="line">  `user_id` bigint(20) UNSIGNED NOT NULL DEFAULT 0, PRIMARY KEY (`comment_ID`) USING BTREE, INDEX `comment_post_ID`(`comment_post_ID`) USING BTREE, INDEX `comment_approved_date_gmt`(`comment_approved`, `comment_date_gmt`) USING BTREE, INDEX `comment_date_gmt`(`comment_date_gmt`) USING BTREE, INDEX `comment_parent`(`comment_parent`) USING BTREE, INDEX `comment_author_email`(`comment_author_email`(10)) USING BTREE</span><br><span class="line">) ENGINE = InnoDB AUTO_INCREMENT = 35 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_520_ci ROW_FORMAT = Dynamic;</span><br></pre></td></tr></table></figure>
<p>这种报错多是你mysql升级到5.7而引起的默认值不兼容的问题。看看你的字段名是什么，我的是时间字段，类型是datetime。想到可能是类型的默认值被限制了，查看 sql_mode。果然：NO_ZERO_IN_DATE,NO_ZERO_DATE这两个参数限制时间不能为0</p>
<h2 id="查看-sql-mode"><a href="#查看-sql-mode" class="headerlink" title="查看 sql_mode"></a>查看 sql_mode</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;sql_mode&apos;; </span><br><span class="line">+---------------+-------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| sql_mode | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |</span><br><span class="line">+---------------+-------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="临时修改："><a href="#临时修改：" class="headerlink" title="临时修改："></a>临时修改：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set session -&gt; sql_mode=&apos;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="永久修改："><a href="#永久修改：" class="headerlink" title="永久修改："></a>永久修改：</h2><p>可以直接修改my.cnf文件</p>
<p>例如：     vim /etc/my.cnf</p>
<p>在[mysqld]下面添加如下列：</p>
<p>sql_mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</p>
<p>ok问题解决，现在你导入或者创建表时看看！</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> MySql </category>
            
        </categories>
        
        
        <tags>
            
            <tag> MySql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[centos6 yum方式升级内核]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Docker/centos6%20yum%E6%96%B9%E5%BC%8F%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/</url>
      <content type="html"><![CDATA[<p>最近没有时间好久没有写文章了，今天由于需要安装docker学习虚拟容器的知识，需要升级OS的内核。目前我这边使用的OS是centos6.5，内核是2.6版本的，如下：</p>
<p>cat /etc/issue</p>
<p>uname -r</p>
<p>因为docker的使用需要3.0以上内核的支持，当然也是可以使用2.6的内核，当时可能会出现不可控制的问题，所以需要我们升级内核版本。</p>
<p>要升级内核OS到3.1以上，需要以下几个步骤。</p>
<h1 id="一、安装elrepo的yum源"><a href="#一、安装elrepo的yum源" class="headerlink" title="一、安装elrepo的yum源"></a><strong>一、安装elrepo的yum源</strong></h1><p>升级内核需要使用elrepo的yum源，在安装yum源之前还需要我们导入elrepo的key，如下：</p>
<p>rpm –import <a href="https://www.elrepo.org/RPM-GPG-KEY-elrepo.org" target="_blank" rel="noopener">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</a></p>
<p>To install ELRepo for RHEL-7, SL-7 or CentOS-7:</p>
<p>rpm -Uvh <a href="http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm" target="_blank" rel="noopener">http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm</a></p>
<p>To make use of our mirror system, please also install yum-plugin-fastestmirror.</p>
<p>To install ELRepo for RHEL-6, SL-6 or CentOS-6:</p>
<p>rpm -Uvh <a href="http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm" target="_blank" rel="noopener">http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm</a></p>
<p>To make use of our mirror system, please also install yum-plugin-fastestmirror.</p>
<p>elrepo的key安装完毕后，我们下面开始正式升级内核。</p>
<h1 id="二、升级内核"><a href="#二、升级内核" class="headerlink" title="二、升级内核"></a><strong>二、升级内核</strong></h1><p>在yum的elrepo源中有ml和lt两种内核，其中ml(mainline)为最新版本的内核，lt为长期支持的内核。</p>
<p>如果要安装ml内核，使用如下命令：</p>
<p>yum –enablerepo=elrepo-kernel -y install kernel-ml</p>
<p>如果要安装lt内核，使用如下命令：</p>
<p>yum –enablerepo=elrepo-kernel -y install kernel-lt</p>
<p>在此我们安装的是lt内核，如下：</p>
<p>内核升级完毕后，不会立即生效，还需要我们修改grub.conf文件。</p>
<h1 id="三、修改grub-conf文件"><a href="#三、修改grub-conf文件" class="headerlink" title="三、修改grub.conf文件"></a><strong>三、修改grub.conf文件</strong></h1><p>内核升级完毕后，需要我们修改内核的启动顺序，默认启动的顺序应该为1,升级以后内核是往前面插入为0，如下：</p>
<p>vim /etc/grub.conf</p>
<p>default=0</p>
<h1 id="四、重启系统并查看系统内核"><a href="#四、重启系统并查看系统内核" class="headerlink" title="四、重启系统并查看系统内核"></a><strong>四、重启系统并查看系统内核</strong></h1><p>grub.conf文件修改完毕后，还需要重启系统，如下：</p>
<p>shutdown -r now</p>
<p>系统启动完毕后，我们来查看内核版本，如下：</p>
<p>uname -r</p>
<p>通过上图，我们可以很容易的看出centos6.5已经升级内核到3.10版本。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Docker </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
            <tag> centos </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mysql错误Error(1133)]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/MySql/mysql%E9%94%99%E8%AF%AFError(1133)/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h3 id="mysql错误Error-1133-Can’t-find-any-matching-row-in-the-user-table"><a href="#mysql错误Error-1133-Can’t-find-any-matching-row-in-the-user-table" class="headerlink" title="mysql错误Error(1133): Can’t find any matching row in the user table"></a>mysql错误Error(1133): Can’t find any matching row in the user table</h3><p>刚尝试修改mysql数据库用户名时，提示”Error (1133): Can’t find any matching row in the user table”，遂找了下网上的解决办法：</p>
<p>从mysql错误代码说明里，可以查到mysql错误1133是数据库用户名不存在，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1133：MYSQL数据库用户不存在</span><br></pre></td></tr></table></figure>
<p>如此，找到的最简单的办法就是在mysql命令行中执行<code>FLUSH PRIVILEGES;</code>这一语句即可。</p>
<p>mysql提示1133错误的原因是，变更了mysql.user表之后，没有使用FLUSH PRIVILEGES命令来更新权限表（grant tables）。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> MySql </category>
            
        </categories>
        
        
        <tags>
            
            <tag> MySql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[htpasswd命令]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Nginx/htpasswd%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<h1 id="htpasswd命令"><a href="#htpasswd命令" class="headerlink" title="htpasswd命令"></a>htpasswd命令</h1><p><strong>htpasswd命令</strong>是Apache的Web服务器内置工具，用于创建和更新储存用户名、域和用户基本认证的密码文件。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><h3 id="htpasswd-选项-参数"><a href="#htpasswd-选项-参数" class="headerlink" title="htpasswd(选项)(参数)"></a>htpasswd(选项)(参数)</h3><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><p>-c：创建一个加密文件；<br>-n：不更新加密文件，只将加密后的用户名密码显示在屏幕上；<br>-m：默认采用MD5算法对密码进行加密；<br>-d：采用CRYPT算法对密码进行加密；<br>-p：不对密码进行进行加密，即明文密码；<br>-s：采用SHA算法对密码进行加密；<br>-b：在命令行中一并输入用户名和密码而不是根据提示输入密码；<br>-D：删除指定的用户。</p>
<h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><ul>
<li>用户：要创建或者更新密码的用户名；</li>
<li>密码：用户的新密码。</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p><strong>利用htpasswd命令添加用户</strong></p>
<p>htpasswd -<a href="http://man.linuxde.net/bc" title="bc命令" target="_blank" rel="noopener">bc</a> .<a href="http://man.linuxde.net/passwd" title="passwd命令" target="_blank" rel="noopener">passwd</a> <a href="http://www.linuxde.net" target="_blank" rel="noopener">www.linuxde.net</a> <a href="http://man.linuxde.net/php" title="php命令" target="_blank" rel="noopener">php</a></p>
<p>在bin目录下生成一个.passwd文件，用户名<a href="http://www.linuxde.net，密码：php，默认采用MD5加密方式。" target="_blank" rel="noopener">www.linuxde.net，密码：php，默认采用MD5加密方式。</a></p>
<p><strong>在原有密码文件中增加下一个用户</strong></p>
<p>htpasswd -b .passwd Jack 123456</p>
<p>去掉<code>-c</code>选项，即可在第一个用户之后添加第二个用户，依此类推。</p>
<p><strong>不更新密码文件，只显示加密后的用户名和密码</strong></p>
<p>htpasswd -nb Jack 123456</p>
<p>不更新.passwd文件，只在屏幕上输出用户名和经过加密后的密码。</p>
<p><strong>利用htpasswd命令删除用户名和密码</strong></p>
<p>htpasswd -D .passwd Jack</p>
<p><strong>利用htpasswd命令修改密码</strong></p>
<p>htpasswd -D .passwd Jack<br>htpasswd -b .passwd Jack 123456</p>
<p>即先使用htpasswd删除命令删除指定用户，再利用htpasswd添加用户命令创建用户即可实现修改密码的功能。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Nginx </category>
            
        </categories>
        
        
        <tags>
            
            <tag> nginx </tag>
            
            <tag> htpasswd </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac OSX开发环境搭建手记]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/Mac-OSX%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E6%89%8B%E8%AE%B0/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h2 id="Brew"><a href="#Brew" class="headerlink" title="Brew"></a>Brew</h2><blockquote>
<p>Brew 是 Mac 下面的包管理工具，通过 Github 托管适合 Mac 的编译配置以及 Patch，可以方便的安装开发工具。 Mac 自带ruby 所以安装起来很方便，同时它也会自动把git也给你装上。官方网站： <a href="http://brew.sh" target="_blank" rel="noopener">http://brew.sh</a> 。</p>
</blockquote>
<blockquote>
<p>安装完成之后，建议执行一下自检，brew doctor如果看到Your system is ready to brew. 那么你的brew已经可以开始使用了。</p>
</blockquote>
<h3 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure>
<h3 id="自检："><a href="#自检：" class="headerlink" title="自检："></a>自检：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew doctor</span><br></pre></td></tr></table></figure>
<h3 id="常用命令：（所有软件以php7-1为例子）"><a href="#常用命令：（所有软件以php7-1为例子）" class="headerlink" title="常用命令：（所有软件以php7.1为例子）"></a>常用命令：（所有软件以php7.1为例子）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">brew update                        #更新brew可安装包，建议每次执行一下</span><br><span class="line">brew search php71                  #搜索php7.1</span><br><span class="line">brew tap josegonzalez/php          #安装扩展&lt;gihhub_user/repo&gt;   </span><br><span class="line">brew tap                           #查看安装的扩展列表</span><br><span class="line">brew install php71                 #安装php7.1</span><br><span class="line">brew remove  php71                 #卸载php7.1</span><br><span class="line">brew upgrade php71                 #升级php7.1</span><br><span class="line">brew options php71                 #查看php7.1安装选项</span><br><span class="line">brew info    php71                 #查看php7.1相关信息</span><br><span class="line">brew home    php71                 #访问php7.1官方网站</span><br><span class="line">brew services list                 #查看系统通过 brew 安装的服务</span><br><span class="line">brew services cleanup              #清除已卸载无用的启动配置文件</span><br><span class="line">brew services restart php71        #重启php-fp</span><br></pre></td></tr></table></figure>
<p>注意：brew services 相关命令最好别经常用了，提示会被移除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  ~  brew services restart php71</span><br><span class="line">Warning: brew services is unsupported and will be removed soon.</span><br><span class="line">You should use launchctl instead.</span><br><span class="line">Please feel free volunteer to support it in a tap.</span><br><span class="line"></span><br><span class="line">Stopping `php71`... (might take a while)</span><br><span class="line">==&gt; Successfully stopped `php71` (label: homebrew.mxcl.php71)</span><br><span class="line">==&gt; Successfully started `php71` (label: homebrew.mxcl.php71)</span><br></pre></td></tr></table></figure>
<h2 id="Oh-My-Zsh"><a href="#Oh-My-Zsh" class="headerlink" title="Oh My Zsh"></a>Oh My Zsh</h2><blockquote>
<p>ohmyzsh &amp; iTerm2两个神器，在Mac os x下是一定要装的. 两组配合起来使用，加上插件。简直是神一样的存在。 秒杀梅西，内马尔啊：） Oh 猛戳到官网</p>
</blockquote>
<h3 id="安装-oh-my-zsh"><a href="#安装-oh-my-zsh" class="headerlink" title="安装 oh my zsh"></a>安装 oh my zsh</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L http://install.ohmyz.sh | sh</span><br></pre></td></tr></table></figure>
<h2 id="安装终端的命令自动提示"><a href="#安装终端的命令自动提示" class="headerlink" title="安装终端的命令自动提示"></a>安装终端的命令自动提示</h2><p>在终端下操作会经常需要输入一些常用的命令，要不出错的输入这些命令也不是件容易的事，zsh还有一个很好用的补全命令的插件zsh-autosuggestions, 我们通过下面命令安装下：</p>
<p><a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">官方地址</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Oh My Zsh</span><br><span class="line"></span><br><span class="line">1. Clone this repository into $ZSH_CUSTOM/plugins (by default ~/.oh-my-zsh/custom/plugins)</span><br><span class="line"></span><br><span class="line">2 .git clone git://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions</span><br><span class="line">Add the plugin to the list of plugins for Oh My Zsh to load:</span><br><span class="line"></span><br><span class="line">3. plugins=(zsh-autosuggestions)</span><br><span class="line"></span><br><span class="line">4. Start a new terminal session.</span><br></pre></td></tr></table></figure></p>
<p>好了，然后你可以执行source ~/.zshrc或者重新打开终端，看下效果：</p>
<p><img src="https://lh3.googleusercontent.com/-kmKtrstTeOI/WNSJJjAa2BI/AAAAAAAAB3E/1fbBeha76NM/s0/2017-03-24_11-49-10.png" alt="自动提示"></p>
<p>如上图，我输入一个b就会自动提示我之前输入过的命令，然后按一下右方向键就能自动补全了。</p>
<h3 id="设置默认shell"><a href="#设置默认shell" class="headerlink" title="设置默认shell"></a>设置默认shell</h3><blockquote>
<p>查看系统支持的shell列表，Mac 10.9.4 自带了 zsh 5.0.2，Linux上得安装。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shells</span><br><span class="line"># List of acceptable shells for chpass(1).</span><br><span class="line"># Ftpd will not allow users to connect who are not using</span><br><span class="line"># one of these shells.</span><br><span class="line"></span><br><span class="line">/bin/bash</span><br><span class="line">/bin/csh</span><br><span class="line">/bin/ksh</span><br><span class="line">/bin/sh</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/zsh</span><br><span class="line">zsh --version</span><br><span class="line">zsh 5.0.2 (x86_64-apple-darwin13.0)</span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<blockquote>
<p>虽然Mac自带了zsh，如果你想要最新版的zsh，那么你用 brew install zsh安装一个最新的吧。/usr/local/bin/zsh –version zsh 5.0.5 (x86_64-apple-darwin13.3.0) 区别也不会很大， 默认的版本已经很新了。</p>
</blockquote>
<h1 id="MySQL-PHP-Nginx"><a href="#MySQL-PHP-Nginx" class="headerlink" title="MySQL PHP Nginx"></a>MySQL PHP Nginx</h1><h2 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install mysql</span><br></pre></td></tr></table></figure>
<p>MySQL开机启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir LaunchAgents</span><br><span class="line">ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span><br></pre></td></tr></table></figure>
<p>安装完成之后开启MySQL安全机制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/opt/mysql/bin/mysql_secure_installation</span><br></pre></td></tr></table></figure>
<p>根据终端提示，输入root密码，然后依次确认一些安全选项。具体信息可以参考<a href="http://blog.frd.mn/install-nginx-php-fpm-mysql-and-phpmyadmin-on-os-x-mavericks-using-homebrew/" target="_blank" rel="noopener">外国友人的这篇文章</a></p>
<h2 id="安装PHP"><a href="#安装PHP" class="headerlink" title="安装PHP"></a>安装PHP</h2><p>添加brew的PHP扩展库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew tap homebrew/dupes</span><br><span class="line">brew tap josegonzalez/homebrew-php</span><br></pre></td></tr></table></figure>
<p>可以使用<code>brew options php71</code>命令来查看安装php7.1的选项，这里我用下面的选项安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install php70 --with-debug --with-gmp --with-homebrew-curl --with-homebrew-libressl --with-homebrew-libxml2 --with-homebrew-libxslt --with-imap --with-libmysql</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PHP编译过程中如果遇到<code>configure: error: Cannot find OpenSSL&#39;s &lt;evp.h&gt;</code>错误，执行<code>xcode-select --install</code>重新安装一下<strong>Xcode Command Line Tools</strong> 在<a href="https://github.com/Homebrew/homebrew-php/issues/1181" target="_blank" rel="noopener">GitHub HomeBrew</a>上有关于这个讨论:<br><em>For future reference of anybody looking for Command Line Tools with Xcode 5, open up a Terminal window and type xcode-select –install. A window will appear informing you command line tools are required. Click Install and you should be good to go</em></p>
</blockquote>
<blockquote>
<p>我安装的时候还遇到了一个奇怪的问题，提示fatal error: ‘my_global.h’ file not found #include &lt;my_global.h&gt; 就是提示各种<code>.h</code>的文件不存在。各种google以后发现了一个论坛的资料给了我一些启发，<a href="https://www.blitzbasic.com/Community/posts.php?topic=102579" target="_blank" rel="noopener">搓这里</a></p>
</blockquote>
<p>里面提到了一下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mysql/include</span><br></pre></td></tr></table></figure></p>
<p>先删除<code>/usr/local/include</code>下的mysql文件夹然后执行下面命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/Cellar/mysql/5.7.17/include/mysql/* /usr/local/include</span><br></pre></td></tr></table></figure>
<p>等待PHP编译完成，开始安装PHP常用扩展，扩展安装过程中brew会自动安装依赖包，例如<code>php71-pdo-pgsql</code> 会自动装上<code>postgresql</code>,这里我安装以下PHP扩展：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">brew install php71-apcu\</span><br><span class="line"> php71-gearman\</span><br><span class="line"> php71-geoip\</span><br><span class="line"> php71-gmagick\</span><br><span class="line"> php71-imagick\</span><br><span class="line"> php71-intl\</span><br><span class="line"> php71-mcrypt\</span><br><span class="line"> php71-memcache\</span><br><span class="line"> php71-memcached\</span><br><span class="line"> php71-mongo\</span><br><span class="line"> php71-opcache\</span><br><span class="line"> php71-pdo-pgsql\</span><br><span class="line"> php71-phalcon\</span><br><span class="line"> php71-redis\</span><br><span class="line"> php71-sphinx\</span><br><span class="line"> php71-swoole\</span><br><span class="line"> php71-uuid\</span><br><span class="line"> php71-xdebug;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>扩展里面提一下<a href="http://phalconphp.com/" target="_blank" rel="noopener">php71-phalcon</a> 和 <a href="http://www.swoole.com/" target="_blank" rel="noopener">php71-swoole</a>. 一个是C语言写的PHP框架，安装来个人摸索熟悉一下，还没有真正的使用过，大致看了一下文档，感觉非常吊炸天。目前公司的项目是基于Yii2的，也看看这个框架。 另外一个<a href="http://www.swoole.com/" target="_blank" rel="noopener">swoole是国产的PHP高性能网络通信框架</a>，貌似不错，可能在项目中会考虑用到它。</p>
</blockquote>
<p>由于Mac自带了php和php-fpm，因此需要添加系统环境变量PATH来替代自带PHP版本,我们用的是zsh,所以放进.zshrc中,如果你用的shell是bash,那么可以把下面的信息写入到~/.bash_profile文件中，如果这个文件没有，你自己建一个就行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;export PATH=&quot;$(brew --prefix php70)/bin:$PATH&quot;  #for php&apos; &gt;&gt; ~/.zshrc</span><br><span class="line">echo &apos;export PATH=&quot;$(brew --prefix php70)/sbin:$PATH&quot;  #for php-fpm&apos; &gt;&gt; ~/.zshrc</span><br><span class="line">echo &apos;export PATH=&quot;/usr/local/bin:/usr/local/sbib:$PATH&quot; #for other brew install soft&apos; &gt;&gt; ~/.zshrc</span><br><span class="line">source ~/.zshrc</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;export PATH=&quot;$(brew --prefix php71)/bin:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile  #for php</span><br><span class="line">echo &apos;export PATH=&quot;$(brew --prefix php71)/sbin:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile  #for php-fpm</span><br><span class="line">echo &apos;export PATH=&quot;/usr/local/bin:/usr/local/sbib:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile #for other brew install soft</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>测试一下效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#brew安装的php 他在/usr/local/opt/php71/bin/php</span><br><span class="line">php -v    </span><br><span class="line">PHP 7.1.3 (cli) (built: Jul 16 2014 15:43:06) (DEBUG)</span><br><span class="line">Copyright (c) 1997-2014 The PHP Group</span><br><span class="line">Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies</span><br><span class="line">    with Zend OPcache v7.0.3, Copyright (c) 1999-2014, by Zend Technologies</span><br><span class="line">    with Xdebug v2.2.5, Copyright (c) 2002-2014, by Derick Rethans </span><br><span class="line"></span><br><span class="line">#Mac自带的PHP</span><br><span class="line">/usr/bin/php -v   </span><br><span class="line">PHP 5.4.24 (cli) (built: Jan 19 2014 21:32:15) </span><br><span class="line">Copyright (c) 1997-2013 The PHP Group</span><br><span class="line">Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies</span><br><span class="line"></span><br><span class="line">#brew安装的php-fpm 他在/usr/local/opt/php71/sbin/php-fpm</span><br><span class="line">php-fpm -v</span><br><span class="line">PHP 7.1.3 (fpm-fcgi) (built: Jul 16 2014 15:43:12) (DEBUG)</span><br><span class="line">Copyright (c) 1997-2014 The PHP Group</span><br><span class="line">Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies</span><br><span class="line">    with Zend OPcache v7.0.3, Copyright (c) 1999-2014, by Zend Technologies</span><br><span class="line">    with Xdebug v2.2.5, Copyright (c) 2002-2014, by Derick Rethans</span><br><span class="line"></span><br><span class="line">#Mac自带的php-fpm</span><br><span class="line">/usr/sbin/php-fpm -v</span><br><span class="line">PHP 5.4.24 (fpm-fcgi) (built: Jan 19 2014 21:32:57)</span><br><span class="line">Copyright (c) 1997-2013 The PHP Group</span><br><span class="line">Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies</span><br></pre></td></tr></table></figure>
<p>修改php-fpm配置文件，<code>vim /usr/local/etc/php/7.0/php-fpm.conf</code>，找到pid相关大概在25行，去掉注释 <code>pid = run/php-fpm.pid</code>, 那么php-fpm的pid文件就会自动产生在<code>/usr/local/var/run/php-fpm.pid</code>，下面要安装的Nginx pid文件也放在这里。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#测试php-fpm配置</span><br><span class="line">php-fpm -t</span><br><span class="line">php-fpm -c /usr/local/etc/php/7.0/php.ini -y /usr/local/etc/php/7.0/php-fpm.conf -t</span><br><span class="line"></span><br><span class="line">#启动php-fpm</span><br><span class="line">php-fpm -D</span><br><span class="line">php-fpm -c /usr/local/etc/php/7.0/php.ini -y /usr/local/etc/php/7.0/php-fpm.conf -D</span><br><span class="line"></span><br><span class="line">#关闭php-fpm</span><br><span class="line">kill -INT `cat /usr/local/var/run/php-fpm.pid`</span><br><span class="line"></span><br><span class="line">#重启php-fpm</span><br><span class="line">kill -USR2 `cat /usr/local/var/run/php-fpm.pid`</span><br><span class="line"></span><br><span class="line">#也可以用上文提到的brew命令来重启php-fpm，不过他官方不推荐用这个命令了</span><br><span class="line">brew services restart php71</span><br><span class="line"></span><br><span class="line">#还可以用这个命令来启动php-fpm</span><br><span class="line"></span><br><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.php70.plist</span><br></pre></td></tr></table></figure>
<p>启动php-fpm之后，确保它正常运行监听9000端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lsof -Pni4 | grep LISTEN | grep php</span><br><span class="line">php-fpm   30907 calvin    9u  IPv4 0xf11f9e8e8033a2a7      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm   30917 calvin    0u  IPv4 0xf11f9e8e8033a2a7      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm   30918 calvin    0u  IPv4 0xf11f9e8e8033a2a7      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm   30919 calvin    0u  IPv4 0xf11f9e8e8033a2a7      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">#正常情况，会看到上面这些进程</span><br></pre></td></tr></table></figure>
<p>PHP-FPM开机启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/opt/php70/*.plist ~/Library/LaunchAgents</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.php70.plist</span><br></pre></td></tr></table></figure>
<p>补充</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">php-fpm的一些管理:</span><br><span class="line"></span><br><span class="line">#测试php-fpm配置</span><br><span class="line">php-fpm -t</span><br><span class="line"></span><br><span class="line">#启动php-fpm</span><br><span class="line">php-fpm -D</span><br><span class="line"></span><br><span class="line">#关闭php-fpm</span><br><span class="line">kill -INT `cat /usr/local/var/run/php-fpm.pid`</span><br><span class="line"></span><br><span class="line">#重启php-fpm</span><br><span class="line">kill -USR2 `cat /usr/local/var/run/php-fpm.pid`</span><br><span class="line"></span><br><span class="line">#也可以用上文提到的brew命令来管理php-fpm</span><br><span class="line">brew services start|stop|restart php70</span><br><span class="line"></span><br><span class="line">#还可以用这个命令来管理php-fpm</span><br><span class="line">php70-fpm start|stop|restart</span><br></pre></td></tr></table></figure>
<p>以上安装出现的问题记录：</p>
<ol>
<li>使用Curl出现的502错误#</li>
</ol>
<p>做有赞接口的时候发现出现了502错误，用下面的测试代码也可以测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$curl = curl_init(); </span><br><span class="line">     // 抓取支付宝首页测试 </span><br><span class="line">     curl_setopt($curl, CURLOPT_URL, &apos;https://www.alipay.com&apos;); </span><br><span class="line">     // 设置header </span><br><span class="line">     curl_setopt($curl, CURLOPT_HEADER, 1); </span><br><span class="line">     // 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上 </span><br><span class="line">     curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); </span><br><span class="line">     // 运行cURL，请求网页数据 </span><br><span class="line">     $data = curl_exec($curl); </span><br><span class="line">     // 关闭cURL请求 </span><br><span class="line">     curl_close($curl); </span><br><span class="line">     // 打印出抓取的测试数据 </span><br><span class="line">     var_dump($data);</span><br></pre></td></tr></table></figure></p>
<p>产生问题的原因：brew安装curl时默认没有带上–with-openssl<br>解决方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 先删除curl</span><br><span class="line">brew uninstall curl</span><br><span class="line"></span><br><span class="line"># 重新安装curl,带上--with-openssl</span><br><span class="line">brew install curl --with-openssl</span><br><span class="line"></span><br><span class="line"># 或者使用brew reinstall</span><br><span class="line">brew reinstall curl --with-openssl</span><br></pre></td></tr></table></figure>
<p>然后重启下php-fpm</p>
<p><strong>安装php composer</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install composer</span><br><span class="line">#检查一下情况</span><br><span class="line">composer --version</span><br><span class="line">Composer version 1.0.0-alpha8 2014-01-06 18:39:59</span><br></pre></td></tr></table></figure>
<blockquote>
<p>redis memcached这些软件brew 已经自动依赖安装上，如果想开机自动启动，或者查看使用说明 <code>brew info redis</code>即可。另外，composer的中文文档：<a href="http://composer.golaravel.com/" target="_blank" rel="noopener">猛戳这里</a></p>
</blockquote>
<h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><p>首先查看一下可选的编译参数</p>
<p>brew options nginx<br>输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--with-debug</span><br><span class="line">        Compile with support for debug log</span><br><span class="line">--with-gunzip</span><br><span class="line">        Compile with support for gunzip module</span><br><span class="line">--with-passenger</span><br><span class="line">        Compile with support for Phusion Passenger module</span><br><span class="line">--with-spdy</span><br><span class="line">        Compile with support for SPDY module</span><br><span class="line">--with-webdav</span><br><span class="line">        Compile with support for WebDAV module</span><br><span class="line">--devel</span><br><span class="line">        install development version 1.7.7</span><br><span class="line">--HEAD</span><br><span class="line">        install HEAD version</span><br></pre></td></tr></table></figure>
<p>可以看到可选的编译参数里没有 GeoIP 模块，那么如果还想用 Homebrew 来安装 nginx，就只有自己修改默认的 Formula 来添加参数，或者使用其他人修改好后共享的 Formula 了。</p>
<p>考虑到之后可能还会用到其他模块，我就没有自己创建 Formula，而是找到了 homebrew/nginx 这个 tap。</p>
<p>首先给 Homebrew 添加这个 tap：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew tap homebrew/nginx</span><br></pre></td></tr></table></figure>
<p>再查看一下可选参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew options nginx-full</span><br></pre></td></tr></table></figure>
<p>可以在结果中看到有 WebDav 模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--with-dav-ext-module</span><br><span class="line">	Build with HTTP WebDav Extended support</span><br></pre></td></tr></table></figure>
<p>这样就可以安装有 WebDav 模块的 nginx 了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx-full --with-webdav --with-dav-ext-module</span><br></pre></td></tr></table></figure>
<p>不只是 WebDav 模块，其他可选模块也可以用同样方法添加.</p>
<p>nginx启动关闭命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">测试配置是否有语法错误</span><br><span class="line">nginx -t</span><br></pre></td></tr></table></figure>
<p>#打开 nginx<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx</span><br></pre></td></tr></table></figure></p>
<p>#重新加载配置|重启|停止|退出 nginx<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload|reopen|stop|quit</span><br></pre></td></tr></table></figure></p>
<p>#也可以使用Mac的launchctl来启动|停止<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</span><br><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</span><br></pre></td></tr></table></figure></p>
<p>Nginx开机启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/opt/nginx-full/*.plist ~/Library/LaunchAgents</span><br><span class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.nginx-full.plist</span><br></pre></td></tr></table></figure>
<p>Nginx监听80端口需要root权限执行，因此：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root:wheel /usr/local/opt/nginx-full/bin/nginx</span><br><span class="line">sudo chmod u+s /usr/local/opt/nginx-full/bin/nginx</span><br></pre></td></tr></table></figure>
<p>配置nginx.conf<br>创建需要用到的目录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/var/log/nginx</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-available</span><br><span class="line">mkdir -p /usr/local/etc/nginx/sites-enabled</span><br><span class="line">mkdir -p /usr/local/etc/nginx/conf.d</span><br><span class="line">mkdir -p /usr/local/etc/nginx/ssl</span><br></pre></td></tr></table></figure></p>
<p>vim /usr/local/etc/nginx/nginx.conf 输入以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log   /usr/local/var/log/nginx/error.log debug;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pid        /usr/local/var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  256;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line"></span><br><span class="line">    access_log  /usr/local/var/log/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    port_in_redirect off;</span><br><span class="line"></span><br><span class="line">    include /usr/local/etc/nginx/sites-enabled/*;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设置nginx php-fpm配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/etc/nginx/conf.d/php-fpm</span><br><span class="line">#proxy the php scripts to php-fpm</span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">    try_files                   $uri = 404;</span><br><span class="line">    fastcgi_pass                127.0.0.1:9000;</span><br><span class="line">    fastcgi_index               index.php;</span><br><span class="line">    fastcgi_intercept_errors    on;</span><br><span class="line">    include /usr/local/etc/nginx/fastcgi.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建默认虚拟主机default<br>vim /usr/local/etc/nginx/sites-available/default输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    root         /var/www/;</span><br><span class="line"></span><br><span class="line">    access_log  /usr/local/var/logs/nginx/default.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        index  index.html index.htm index.php;</span><br><span class="line">        autoindex   on;</span><br><span class="line">        include     /usr/local/etc/nginx/conf.d/php-fpm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location = /info &#123;</span><br><span class="line">        allow   127.0.0.1;</span><br><span class="line">        deny    all;</span><br><span class="line">        rewrite (.*) /.info.php;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page  404     /404.html;</span><br><span class="line">    error_page  403     /403.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建ssl默认虚拟主机default-ssl<br>vim /usr/local/etc/nginx/sites-available/default-ssl输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       443;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    root       /var/www/;</span><br><span class="line"></span><br><span class="line">    access_log  /usr/local/var/logs/nginx/default-ssl.access.log  main;</span><br><span class="line"></span><br><span class="line">    ssl                  on;</span><br><span class="line">    ssl_certificate      ssl/localhost.crt;</span><br><span class="line">    ssl_certificate_key  ssl/localhost.key;</span><br><span class="line"></span><br><span class="line">    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    ssl_protocols  SSLv2 SSLv3 TLSv1;</span><br><span class="line">    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers   on;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        include   /usr/local/etc/nginx/conf.d/php-fpm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location = /info &#123;</span><br><span class="line">        allow   127.0.0.1;</span><br><span class="line">        deny    all;</span><br><span class="line">        rewrite (.*) /.info.php;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page  404     /404.html;</span><br><span class="line">    error_page  403     /403.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建phpmyadmin虚拟主机</p>
<p>vim /usr/local/etc/nginx/sites-available/phpmyadmin #输入以下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       306;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    root    /usr/local/share/phpmyadmin;</span><br><span class="line"></span><br><span class="line">    error_log   /usr/local/var/logs/nginx/phpmyadmin.error.log;</span><br><span class="line">    access_log  /usr/local/var/logs/nginx/phpmyadmin.access.log main;</span><br><span class="line"></span><br><span class="line">    ssl                  on;</span><br><span class="line">    ssl_certificate      ssl/phpmyadmin.crt;</span><br><span class="line">    ssl_certificate_key  ssl/phpmyadmin.key;</span><br><span class="line"></span><br><span class="line">    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    ssl_protocols  SSLv2 SSLv3 TLSv1;</span><br><span class="line">    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers   on;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        index  index.html index.htm index.php;</span><br><span class="line">        include   /usr/local/etc/nginx/conf.d/php-fpm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设置SSL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/etc/nginx/ssl</span><br><span class="line">openssl req -new -newkey rsa:4096 -days 365 -nodes -x509 -subj &quot;/C=US/ST=State/L=Town/O=Office/CN=localhost&quot; -keyout /usr/local/etc/nginx/ssl/localhost.key -out /usr/local/etc/nginx/ssl/localhost.crt</span><br><span class="line">openssl req -new -newkey rsa:4096 -days 365 -nodes -x509 -subj &quot;/C=US/ST=State/L=Town/O=Office/CN=phpmyadmin&quot; -keyout /usr/local/etc/nginx/ssl/phpmyadmin.key -out /usr/local/etc/nginx/ssl/phpmyadmin.crt</span><br></pre></td></tr></table></figure>
<p>创建虚拟主机软连接，开启虚拟主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/local/etc/nginx/sites-available/default /usr/local/etc/nginx/sites-enabled/default</span><br><span class="line">ln -sfv /usr/local/etc/nginx/sites-available/default-ssl /usr/local/etc/nginx/sites-enabled/default-ssl</span><br><span class="line">ln -sfv /usr/local/etc/nginx/sites-available/phpmyadmin /usr/local/etc/nginx/sites-enabled/phpmyadmin</span><br></pre></td></tr></table></figure>
<p>启动|停止Nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx-full.plist</span><br><span class="line">launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.nginx-full.plist</span><br></pre></td></tr></table></figure>
<p>设置快捷服务控制命令<br>为了后面管理方便，将命令 alias 下，vim ~/.zsh_aliases 输入一下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">alias nginx.start=&apos;launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx-full.plist&apos;</span><br><span class="line">alias nginx.stop=&apos;launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.nginx-full.plist&apos;</span><br><span class="line">alias nginx.restart=&apos;nginx.stop &amp;&amp; nginx.start&apos;</span><br><span class="line">alias php-fpm.start=&quot;launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.php70.plist&quot;</span><br><span class="line">alias php-fpm.stop=&quot;launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.php70.plist&quot;</span><br><span class="line">alias php-fpm.restart=&apos;php-fpm.stop &amp;&amp; php-fpm.start&apos;</span><br><span class="line">alias mysql.start=&quot;launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist&quot;</span><br><span class="line">alias mysql.stop=&quot;launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist&quot;</span><br><span class="line">alias mysql.restart=&apos;mysql.stop &amp;&amp; mysql.start&apos;</span><br><span class="line">alias redis.start=&quot;launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.redis.plist&quot;</span><br><span class="line">alias redis.stop=&quot;launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.redis.plist&quot;</span><br><span class="line">alias redis.restart=&apos;redis.stop &amp;&amp; redis.start&apos;</span><br><span class="line">alias memcached.start=&quot;launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.memcached.plist&quot;</span><br><span class="line">alias memcached.stop=&quot;launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.memcached.plist&quot;</span><br><span class="line">alias memcached.restart=&apos;memcached.stop &amp;&amp; memcached.start&apos;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#让快捷命令生效</span><br><span class="line">echo &quot;[[ -f ~/.zsh_aliases ]] &amp;&amp; . ~/.zsh_aliases&quot; &gt;&gt; ~/.zshrc     </span><br><span class="line">source ~/.zshrc</span><br><span class="line">#创建站点目录到主目录，方便快捷访问</span><br><span class="line">ln -sfv /var/www ~/htdocs</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> nginx </tag>
            
            <tag> Mac技巧 </tag>
            
            <tag> php </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Why is @font-face throwing a 404 error on woff files?]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/IIS/Why-is-font-face-throwing-a-404-error-on-woff-files/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>I also came across the same issue. I think doing this configuration from the server level would be better since it applies for all the websites.</p>
<ol>
<li>Go to IIS root node and double-click the <code>MIME Types</code> configuration option</li>
<li>Click “Add” link in the Actions panel on the top right.</li>
<li>This will bring up a dialog. Add .woff file extension and specify <code>application/x-font-wof</code> as the corresponding MIME type.</li>
</ol>
<p>Add MIME Type for <code>.woff</code> file name extension</p>
<p><img src="https://lh3.googleusercontent.com/-BwnUFnLQpJA/WLJuyRrq9xI/AAAAAAAABtQ/5egeZtwfb5w/s0/2017-02-26_14-59-36.png" alt><br><img src="https://lh3.googleusercontent.com/-S3VlMYYqh2g/WLJu8FHq3bI/AAAAAAAABtU/vRpmUMPhJQE/s0/2017-02-26_15-00-16.png" alt></p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> IIS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> IIS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[0x80004005 未指定的错误]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/IIS/0x80004005-%E6%9C%AA%E6%8C%87%E5%AE%9A%E7%9A%84%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<blockquote>
<p>0x80004005 未指定的错误 (Provider 错误’80004005’ 未指定的错误) 你是否也在烦恼中，今天下午这个问题烦恼了我一个下午。首先说下我的经历。下午帮来要写程序，拿移动硬盘出来 打开提示 I/O设备错误。一看完蛋了移动硬盘坏了，然后找了个修改软件 安装了下。修复好了。然后用BAT 清理下垃圾文件。然后问题就出现了。</p>
</blockquote>
<p>后来终于发现问题是 出在 BAT 清理垃圾文件 哪里。就是把权限改了。大家不用去看太多<br>的解释了。如果自己没搞什么东西。有70%就是 权限问题。下面说下怎么解决这个问题：</p>
<h2 id="设置temp（临时文件夹）权限"><a href="#设置temp（临时文件夹）权限" class="headerlink" title="设置temp（临时文件夹）权限"></a>设置temp（临时文件夹）权限</h2><h3 id="打开办法："><a href="#打开办法：" class="headerlink" title="打开办法："></a>打开办法：</h3><p><code>windows---&gt;temp</code>，单击右键选择-属性，你就会看到一个叫做“<code>安全</code>”的选项，</p>
<p>添加一个<code>everyone</code>,权限设置为完全控制，再将你正在使用<code>windows</code>的用户也设置为完全控制</p>
<p>一般设置好这个就没问题了。如果你还有问题。那么你可能是 组件有问题了。或者是本身</p>
<p>代码没写好。或者是 程序目录权限问题。</p>
<p>下面在说常见的解决办法：</p>
<h2 id="重新注册组件："><a href="#重新注册组件：" class="headerlink" title="重新注册组件："></a>重新注册组件：</h2><p>开始—–运行—–<code>regsvr32 jscript.dll</code><br>开始—–运行—–<code>regsvr32 vbscript.dll</code><br>开始—–运行—–<code>iisreset</code></p>
<p>开始—&gt;运行， 输入 <code>regsvr32 msjetoledb40.dll</code></p>
<p>如果还是不能解决。那么问题肯定出现到 代码上。或者你程序的目录权限上！</p>
<p>程序一般错误在 链接数据库代码。不规范。大家按照下面这个写就可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbpath=server.mappath(&quot;vip/jiajie.mdb&quot;) </span><br><span class="line">set conn=server.createobject(&quot;adodb.connection&quot;) </span><br><span class="line">conn.open &quot;provider=microsoft.jet.oledb.4.0;data source=&quot;&amp;dbpath</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> IIS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> IIS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Sublime配置文件同步]]></title>
      <url>https://github.jiangnan.pw/%E8%BD%AF%E4%BB%B6%E7%9B%B8%E5%85%B3/Windows/Sublime%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h1 id="Sublime-Config"><a href="#Sublime-Config" class="headerlink" title="Sublime Config"></a>Sublime Config</h1><p>The simplest method of installation is through the Sublime Text console. The console is accessed via the ctrl+` shortcut or the View &gt; Show Console menu. Once open, paste the appropriate Python code for your version of Sublime Text into the console.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request,os,hashlib; h = &apos;df21e130d211cfc94d9b0905775a7c0f&apos; + &apos;1e3d39e33b79698005270310898eea76&apos;; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( &apos;http://packagecontrol.io/&apos; + pf.replace(&apos; &apos;, &apos;%20&apos;)).read(); dh = hashlib.sha256(by).hexdigest(); print(&apos;Error validating download (got %s instead of %s), please try manual install&apos; % (dh, h)) if dh != h else open(os.path.join( ipp, pf), &apos;wb&apos; ).write(by)</span><br></pre></td></tr></table></figure>
<h2 id="账户-SSH-公钥"><a href="#账户-SSH-公钥" class="headerlink" title="账户 SSH 公钥"></a>账户 SSH 公钥</h2><blockquote>
<p>账户 SSH 公钥是跟用户账户关联的公钥，一旦设置，SSH 就拥有账户下所有项目仓库的读写权限。 设置“账户 SSH 公钥”是开发者使用 SSH 方式访问/修改代码仓库的“前置工作”，分为“获取 SSH 协议地址”、“生成公钥”、“在 Coding.net 添加公钥”三个步骤。</p>
</blockquote>
<h2 id="获取-SSH-协议地址"><a href="#获取-SSH-协议地址" class="headerlink" title="获取 SSH 协议地址"></a>获取 SSH 协议地址</h2><blockquote>
<p>在项目的代码页面点击 SSH 切换到 SSH 协议， 获得 clone 地址，形如<a href="mailto:git@git.coding.net" target="_blank" rel="noopener">git@git.coding.net</a>:wzw/leave-a-message.git。 请使用这个地址来访问您的代码仓库。</p>
</blockquote>
<h2 id="生成公钥"><a href="#生成公钥" class="headerlink" title="生成公钥"></a>生成公钥</h2><blockquote>
<p>Mac/Linux 打开命令行终端, Windows 打开 Git Bash 。 输入ssh-keygen -t rsa -C “<a href="mailto:username@example.com" target="_blank" rel="noopener">username@example.com</a>”,( 注册的邮箱)，接下来点击enter键即可（也可以输入密码）。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</span><br><span class="line"># Creates a new ssh key, using the provided email as a label</span><br><span class="line"># Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]  // 推荐使用默认地址,如果使用非默认地址可能需要配置 .ssh/config</span><br></pre></td></tr></table></figure>
<p>成功之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Your identification has been saved in /Users/you/.ssh/id_rsa.</span><br><span class="line"># Your public key has been saved in /Users/you/.ssh/id_rsa.pub.</span><br><span class="line"># The key fingerprint is:</span><br><span class="line"># 01:0f:f4:3b:ca:85:d6:17:a1:7d:f0:68:9d:f0:a2:db your_email@example.com</span><br></pre></td></tr></table></figure>
<h2 id="在-Coding-net-添加公钥"><a href="#在-Coding-net-添加公钥" class="headerlink" title="在 Coding.net 添加公钥"></a>在 Coding.net 添加公钥</h2><blockquote>
<p>本地打开 id_rsa.pub 文件（或执行 $cat id_rsa.pub ），复制其中全部内容，添加到账户“SSH 公钥”页面 中，公钥名称可以随意起名字。<br>完成后点击“添加”，然后输入密码或动态码即可添加完成。 图片<br>完成后在命令行测试，首次建立链接会要求信任主机。</p>
</blockquote>
<h2 id="Git-初始化"><a href="#Git-初始化" class="headerlink" title="Git 初始化"></a>Git 初始化</h2><p>…or create a new repository on the command line<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;# test&quot; &gt;&gt; README.md</span><br><span class="line">git init</span><br><span class="line">git add README.md</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git remote add origin git@github.com:lovedan/test.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure></p>
<p>…or push an existing repository from the command line<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com:lovedan/test.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>git pull push在没有指定branch报错的解决方法</p>
<blockquote>
<p>解决方案：指定当前工作目录工作分支，跟远程的仓库，分支之间的链接关系。比如我们设置master对应远程仓库的master分支git branch –set-upstream master origin/master这样在我们每次想push或者pull的时候，只需要 输入git push 或者git pull即可。</p>
</blockquote>
</li>
<li><p>git pull 遇到fatal: refusing to merge unrelated histories</p>
<blockquote>
<p>git pull origin branchname –allow-unrelated-histories</p>
</blockquote>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> 软件相关 </category>
            
            <category> Windows </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Sublime </tag>
            
            <tag> 编程软件 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[找回Sierra允许“任何来源”的应用]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/%E6%89%BE%E5%9B%9ESierra%E5%85%81%E8%AE%B8%E2%80%9C%E4%BB%BB%E4%BD%95%E6%9D%A5%E6%BA%90%E2%80%9D%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>苹果秋季发布会之后，同时进行了两大平台系统的升级（Mac OS 和 iOS），这两天安装第三方Mac应用的时候，突然发现应用权限选项“任何来源”不翼而飞了</p>
<p><img src="http://upload-images.jianshu.io/upload_images/355579-85be4234e1b9bf47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这就直接导致安装第三方app失败了，google了一下找到了找回“任何来源”方法。</p>
<p>打开终端，键入命令，输入密码，然后回车<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo spctl --master-disable</span><br></pre></td></tr></table></figure></p>
<p>然后打开“安全性与隐私”，发现久违的“任何来源”回来了</p>
<p><img src="http://upload-images.jianshu.io/upload_images/355579-7ae01f6b94f2df4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>注：如果在系统偏好设置的“安全与隐私”中重新选中允许App Store 和被认可的开发者App，允许“任何来源”App的选项会再次消失，可运行上述命令再次打开“任何来源”。</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[移除Mac的.DS_Store、._ 檔]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/%E7%A7%BB%E9%99%A4Mac%E7%9A%84-DS-Store%E3%80%81-%E6%AA%94/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>這教學不單對Mac 的用戶有效，只要你的電腦跟Mac 機的Dropbox 同步過，都會發現電腦里出現大量的小檔案，而且全部檔案的開首都是 “._” (dot underscore)。</p>
<p>雖然對系統的儲存空間影響很少，但同步的過程會因為要處理的檔案非常多而影響效能，尤其對於使用外置記憶卡的我。</p>
<p>據說，這些.DS_Store 檔案是記錄資料夾的文件資料的（如果打開系統資訊 ，會顯示不同類型的檔案佔用的空間），如果剷除了，”Storage” 就會就會把所有檔案顯示成 “Others” 。</p>
<h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>這些檔案其實是隱藏的，所以要讓系統顯示所有檔案：<br>1.在Terminal 輸入：【<code>defaults write com.apple.finder appleshowallfiles true</code>】</p>
<p>這樣就會修改系統的設定，讓系統顯示全部檔案，包括被隱藏的。</p>
<h2 id="制止-DS-Store繼續產生"><a href="#制止-DS-Store繼續產生" class="headerlink" title="制止.DS_Store繼續產生"></a>制止<code>.DS_Store</code>繼續產生</h2><p>1.下載 Death_To_DS_Store (直接下載：<a href="http://www.aorensoftware.com/Downloads/Files/DeathToDSStore.zip" target="_blank" rel="noopener">http://www.aorensoftware.com/Downloads/Files/DeathToDSStore.zip</a> )<br>2.直接開啟解壓出來的 <code>Death_To_DSStore.app</code> （剔選Launch Agent來自動啟動這軟件，那麼一開機就會開始阻止 <code>.DS_Store</code>）</p>
<h2 id="剷除所有-檔案（dot-clean-）——不能一勞永逸"><a href="#剷除所有-檔案（dot-clean-）——不能一勞永逸" class="headerlink" title="剷除所有._ 檔案（dot_clean()）——不能一勞永逸"></a>剷除所有<code>._ 檔案</code>（<code>dot_clean()</code>）——不能一勞永逸</h2><p>這方法會剷除所有存在在儲存空間的 “<code>._</code>“ 檔，而系統也不會重新產生這些檔案；但對於新的檔案，還是會有 <code>._</code> 檔案的。</p>
<p>現有的付費方案 (<code>BlueHarvest</code>，售價<code>HKD108</code>)，也只是把以下的工序自動化，并在每次寫檔案時執行一次而已。<br>1.打開Terminal，輸入【dot_clean /path_to_folder/】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(e.g.) dot_clean /Users/alan/Documents</span><br></pre></td></tr></table></figure></p>
<p>這樣系統就會自動把 ._ 的檔案信息融合到原本的檔案。如果原本的檔案消失了，都會被剷除。</p>
<p>建議一個星期執行一次就可以了，一次過把所有這類型的檔案鏟掉。</p>
<h2 id="在Windows-上剷掉-檔"><a href="#在Windows-上剷掉-檔" class="headerlink" title="在Windows 上剷掉 ._ 檔"></a>在Windows 上剷掉 <code>._</code> 檔</h2><p>如果大家同時再Mac 跟 Windows 系統上用Dropbox 同步文件的話，相信大家都會看過，即使在Windows 上也發現這些煩人的檔案；就算沒有用 Dropbox, 用 USB Thumbdrive 把檔案傳來傳去時，Mac 系統也會“順便”把這些檔案“附送”給Windows。</p>
<p>要剷除的話，其實很簡單，只需要一句 CMD Command 【Run: “cmd”】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir /S ._*</span><br></pre></td></tr></table></figure></p>
<p>這個可以在剷除檔案前，確保沒有亂剷<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">del /S ._*</span><br></pre></td></tr></table></figure></p>
<p>好了，真的要動手咯～</p>
<p>解釋一下</p>
<ul>
<li><code>/S</code>: 就是 Recursive 的意思，就是徹底搜出 ._ 的檔案</li>
<li><code>*</code>: 是asterisk, wildcard 的意思啦～</li>
</ul>
<h2 id="後話"><a href="#後話" class="headerlink" title="後話"></a>後話</h2><p>其實如果不使用【Dropbox】 和 【外置儲存裝置】的話，系統這個預設的行為是沒有影響的；但這系統的行為影響最大的是【外置儲存裝置】。</p>
<p>由於SSD 對我最主要的用途是快速啟動軟件，跟暫時處理檔案用的。如果用作同步，這些經常讀寫檔案的行為，還是用【外置儲存裝置】比較划算（這算不算）</p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OS X 10.10.5 下做端口转发]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/OS%20X%2010.10.5%20%E4%B8%8B%E5%81%9A%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>网上搜索了一下相关的资料，都是介绍用pf来做转发，而且都是转发到127.0.0.1。由于我是需要转发到虚拟机上，按网上的教程测试了一下pf，结果是没能转发成功。最后找到了socat这个程序，终于解决问题。</p>
<p>安装socat，前提是你已经有homebrew，没有的话参考这篇来安装homebrew。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install socat</span><br></pre></td></tr></table></figure></p>
<p>安装完成后，执行下面命令就可以完成转发。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo socat TCP4-LISTEN:80,fork TCP4:192.168.173.129:80</span><br></pre></td></tr></table></figure></p>
<p>这条命令是将本机的80端口转发至虚拟机的80端口，虚拟机IP为192.168.173.129。</p>
<p>高级例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lsof -c socat | grep LISTEN</span><br><span class="line">socat -d -d -lf /var/log/socat.log TCP4-LISTEN:13389,reuseaddr,fork,su=nobody TCP4:192.168.1.209:3389 &amp;</span><br><span class="line">socat -d -d -lf /var/log/socat.log TCP4-LISTEN:5902,reuseaddr,fork,su=nobody TCP4:192.168.1.13:5900 &amp;</span><br><span class="line">lsof -c socat | egrep &apos;LISTEN|UDP&apos;</span><br><span class="line">socat UDP4-RECVFROM:500,fork UDP4-SENDTO:192.168.1.209:500</span><br><span class="line">socat UDP4-RECVFROM:4500,fork UDP4-SENDTO:192.168.1.209:4500</span><br><span class="line">lsof -i udp | egrep &apos;isakmp|ipsec-msft&apos; #500，4500端口占用</span><br></pre></td></tr></table></figure>
<p>操作完成。</p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[让git push命令不再需要密码]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Git/%E8%AE%A9git-push%E5%91%BD%E4%BB%A4%E4%B8%8D%E5%86%8D%E9%9C%80%E8%A6%81%E5%AF%86%E7%A0%81/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>最近利用jekyll写博客，为的就是博客管理方便，但是在上传博客的时候使用<code>git push</code>命令每次都得输入github帐号和密码特别的不方便，于是就搜了一下。</p>
<p>在这篇文章里提到，<code>GitHub</code>获得远程库时，有<code>ssh</code>方式和<code>https</code>方式。</p>
<p><img src="https://lh3.googleusercontent.com/-ZUfeXHqFx4w/WJvtMYHET_I/AAAAAAAABdE/bJQdF5oIxHo/s0/2017-02-09_13-16-51.png" alt><br><img src="https://lh3.googleusercontent.com/-sz3NFWCpl1E/WJvtWKfPzYI/AAAAAAAABdI/AmCzzhSMpJc/s0/2017-02-09_13-17-30.png" alt></p>
<p>两个方式的<code>url</code>地址不同，认证方式也不同。使用<code>ssh</code>时保存密钥对以后可以不再输入帐号密码，而<code>https</code>却不能。所以如果想要不再输入帐号密码，一种方式就是在<code>git clone</code>的时候使用<code>ssh</code>方式，另一种方式就是去修改已有项目<code>.git</code>目录下的<code>config</code>文件中的<code>url</code>，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">    url = git@github.com:suyan/suyan.github.io.git</span><br><span class="line">    fetch = +refs/heads/*:refs/remotes/origin/*</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Git </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Git </tag>
            
            <tag> GitHub </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GitHub初心者の僕が、初めてGitHubリポジトリにpushしたら、rejectedエラーになったので、ちゃんとpushできるようになるまでの対応をメモしました。]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Git/git%E3%81%A7push%E5%BE%8Crejected%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AE%E5%AF%BE%E5%BF%9C%E3%83%A1%E3%83%A2/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><hr>
<p>GitHub初心者の僕が、初めてGitHubリポジトリにpushしたら、rejectedエラーになったので、ちゃんとpushできるようになるまでの対応をメモしました。</p>
<h2 id="Gitバージョン"><a href="#Gitバージョン" class="headerlink" title="Gitバージョン"></a>Gitバージョン</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% git --version</span><br><span class="line">git version 2.9.2</span><br></pre></td></tr></table></figure>
<h2 id="作業の流れ"><a href="#作業の流れ" class="headerlink" title="作業の流れ"></a>作業の流れ</h2><p>GitHubからリポジトリを作成</p>
<p>「Initialize this repository with a README」にチェック</p>
<p>ローカルリポジトリに追加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% git add -A</span><br></pre></td></tr></table></figure></p>
<p>ロカールリポジトリにコミット<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% git commit -m &quot;xxxxx&quot;</span><br></pre></td></tr></table></figure></p>
<p>リモートリポジトリ（GitHub）の情報を追加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% git remote add origin https://github.com/xxxx/xxxxx.git</span><br></pre></td></tr></table></figure></p>
<p>ローカルリポジトリをリモートリポジトリへ反映させる → <code>rejectedエラー</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">% git push origin master</span><br><span class="line">To https://github.com/xxxx/xxxxx.git</span><br><span class="line"> ! [rejected]        master -&gt; master (fetch first)</span><br><span class="line">error: failed to push some refs to &apos;https://github.com/xxxx/xxxxx.git&apos;</span><br><span class="line">hint: Updates were rejected because the remote contains work that you do</span><br><span class="line">hint: not have locally. This is usually caused by another repository pushing</span><br><span class="line">hint: to the same ref. You may want to first integrate the remote changes</span><br><span class="line">hint: (e.g., &apos;git pull ...&apos;) before pushing again.</span><br><span class="line">hint: See the &apos;Note about fast-forwards&apos; in &apos;git push --help&apos; for details.</span><br></pre></td></tr></table></figure>
<p>ググってみたら「git fetch &amp;&amp; git merge origin/master」してからpushすればOKと書いてあったので試してみる → <code>mergeエラー</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% git fetch &amp;&amp; git merge origin/master</span><br><span class="line">fatal: refusing to merge unrelated histories</span><br></pre></td></tr></table></figure></p>
<p>さらにググってみたらmergeのオプションに「–allow-unrelated-histories」をつければOKと書いてあったので試してみる → <code>merge OK!</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">% git merge --allow-unrelated-histories origin/master</span><br><span class="line">Merge made by the &apos;recursive&apos; strategy.</span><br><span class="line"> README.md | 2 ++</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 README.md</span><br></pre></td></tr></table></figure>
<p>再度、ローカルリポジトリをリモートリポジトリへ反映させる → <code>push OK!</code></p>
<p>一件落着</p>
<h2 id="「–allow-unrelated-histories」について"><a href="#「–allow-unrelated-histories」について" class="headerlink" title="「–allow-unrelated-histories」について"></a>「–allow-unrelated-histories」について</h2><hr>
<p>ちゃんと調べてみたところ<br>Git 2.9から mergeコマンドとpullコマンドでは，–allow-unrelated-historiesを指定しない限り，無関係なヒストリを持つ２つのブランチをマージすることはできなくなった。<br>とありました。</p>
<h2 id="考察"><a href="#考察" class="headerlink" title="考察"></a>考察</h2><hr>
<p>まだ、GitHub、Gitの理解が浅いので見当違いなことを言っているかもしれませんが、GitHub上でリポジトリを作成したタイミングで、README.mdがコミットされているのに、それをローカルリポジトリに取り込まずに、ローカルのソースをコミットしてしまったのが原因と思われる。<br>結果、それぞれが別ヒストリとなり、mergeエラーになったのかなと。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Git </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Git </tag>
            
            <tag> GitHub </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Laravel5自定义环境变量]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Laravel/Laravel%205%20%E8%87%AA%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>Laravel 5 中提供了一种通过<code>.env</code>文件定义环境变量的方式，根据官方文档的说明应该在不同的环境下使用不同的<code>.env</code>文件，并且此文件不应该提交到版本控制中去。如此设定自然是为了方便不同的环境或者多名开发人员完全可以使用自已的<code>.env</code>环境变量。</p>
<p>但是官方文档中对于如何自定义<code>.env</code>文件中的环境变量却提的很少。文档中只提及了在需要自定义环境变量时最好是在<code>.env.example</code>文件中写一份变量的定义，以方便其他开发人员配置。</p>
<p>下面就以我的“遭遇”来讲下 Laravel 5 中如何自定义环境变量。</p>
<p>（内容比较啰嗦，可直接跳到最后<a href="#环境变量的正确用法">环境变量的正确用法</a>部分）</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>因为我需要路由里面根据不同的二级域名选择不同的控制器，而测试环境和生产环境中的顶级域名不同，于是我打算把顶级域名作为一项环境变量写在<code>.env</code>文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.env</span><br><span class="line"></span><br><span class="line">APP_BASE_URL=test.com</span><br></pre></td></tr></table></figure>
<p>路由中的写法（为了演示我把路由的处理直接写成了闭包，而实际用于生产环境的代码是不能写成闭包的，原因就是路由缓存不支持闭包，不打算使用路由缓存的可以无视）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">route.php</span><br><span class="line"></span><br><span class="line">$_app_base_url = env(<span class="string">'APP_BASE_URL'</span>);</span><br><span class="line">Route::group([<span class="string">'domain'</span> =&gt; <span class="string">"u.&#123;$_app_base_url&#125;"</span>], <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="string">"TEST"</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>恶梦就此开始。</p>
<h2 id="env-函数与-ENV超全局变量"><a href="#env-函数与-ENV超全局变量" class="headerlink" title="env()函数与$_ENV超全局变量"></a><code>env()</code>函数与<code>$_ENV</code>超全局变量</h2><p>这种写法本身是没有任何问题的，访问<code>u.test.com</code>，在开发环境中一切正常。然后使用命令<code>php artisan config:cache</code>生成配置缓存后却出现了找不到控制器的错误。经过调试发现<code>$_app_base_url</code>的输出值是<code>null</code>。</p>
<p><code>env()</code>函数的作用是从<code>$_ENV</code>超全局变量中取出对应的值，而 Laravel 在启动的时候又会自动加载<code>.env</code>文件中的信息到<code>$_ENV</code>超全局变量中，所以如果没问题的话在<code>$_ENV</code>环境变量中应该能找到刚才定义的环境变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump($_ENV);</span><br></pre></td></tr></table></figure>
<p>输出了很多环境变量的信息，但。。。没有看到任何在<code>.env</code>里面定义的信息。难道信息没有被加载到<code>$_ENV</code>？于是尝试清除配置缓存：<code>php artisan config:clear</code>后再尝试，发现<code>.env</code>里面的信息确实被加载到了<code>$_ENV</code>超全局变量中。。。</p>
<p>看来这个问题和配置缓存脱不了关系了。</p>
<h2 id="配置缓存"><a href="#配置缓存" class="headerlink" title="配置缓存"></a>配置缓存</h2><p>Laravel 中为了加快程序的执行效率做了很多缓存优化的工作，其中就包括配置缓存、路由缓存等，通过把多个零碎的配置文件合并成一个大的配置文件来减少加载的文件数量，从而加快运行速度（如果你研究过PHP的性能的话就会知道IO操作其实占了很大一部分开销）。</p>
<p>Laravel 的配置缓存被保存在<code>bootstrap/cache/config.php</code>文件中。打开这个文件可以看到这个文件就是把<code>config</code>文件夹的所有文件合并成了一个大的配置文件。<code>config.php</code>直接返回一个数组，数组的键名对应<code>config</code>文件夹下的文件名，数组的值对应<code>config</code>文件夹下文件返回的配置信息。</p>
<p>找遍整个配置文件发现没有任何和<code>.env</code>文件里面的定义相关的内容。</p>
<p>难道<code>env()</code>函数会从配置缓存中读取数据，因为这个文件里面没有对应的数据所以才返回<code>null</code>？抱着这个想法去查看<code>env()</code>的源码，发现这个函数和配置缓存没任何关系。。。</p>
<h2 id="env文件的加载"><a href="#env文件的加载" class="headerlink" title=".env文件的加载"></a><code>.env</code>文件的加载</h2><p>这时我产生一个想法：有没有可能是框架检测存在配置缓存文件时就不去加载<code>.env</code>了呢？</p>
<p>如果是这样的话框架源码里面肯定会有地方去判断<code>bootstrap/cache/config.php</code>文件是否存在。</p>
<p>直接在<code>vendor</code>里面搜<code>cache/config.php</code>，果然找到在<code>vendor/laravel/framework/src/Illuminate/Foundation/Application.php</code>的第836行（关于文件和行的信息都是基本我现在使用的 Laravel 5.2.31，版本号不同具体位置也可能不同）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Application.php</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Get the path to the configuration cache file.</span><br><span class="line"> *</span><br><span class="line"> * @return string</span><br><span class="line"> */</span><br><span class="line">public function getCachedConfigPath()</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;bootstrapPath().&apos;/cache/config.php&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>getCachedConfigPath()</code>函数返回了这个配置缓存文件的路径。继续查找这个函数，发现除了控制台部分外共有两个地方使用了这个函数，分别是<code>Illuminate\Foundation\Bootstrap\LoadConfiguration::LoadConfiguration和Illuminate\Foundation\Application::configurationIsCached</code>。前者是判断如果配置缓存文件存在就包含它，并不再从<code>config</code>文件夹下加载配置文件；后者是定义了一个<code>configurationIsCached()</code>函数用于返回配置缓存文件是否存在。</p>
<p>根据线索继续查找<code>configurationIsCached()</code>函数，找到了唯一的调用方：<code>vendor/laravel/framework/src/Illuminate/Foundation/Bootstrap/DetectEnvironment.php</code>的第19行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">DetectEnvironment.php</span><br><span class="line"></span><br><span class="line">class DetectEnvironment</span><br><span class="line">&#123;</span><br><span class="line">    /**</span><br><span class="line">     * Bootstrap the given application.</span><br><span class="line">     *</span><br><span class="line">     * @param  \Illuminate\Contracts\Foundation\Application  $app</span><br><span class="line">     * @return void</span><br><span class="line">     */</span><br><span class="line">    public function bootstrap(Application $app)</span><br><span class="line">    &#123;</span><br><span class="line">        if (! $app-&gt;configurationIsCached()) &#123;</span><br><span class="line">            $this-&gt;checkForSpecificEnvironmentFile($app);</span><br><span class="line">            try &#123;</span><br><span class="line">                (new Dotenv($app-&gt;environmentPath(), $app-&gt;environmentFile()))-&gt;load();</span><br><span class="line">            &#125; catch (InvalidPathException $e) &#123;</span><br><span class="line">                //</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在<code>bootstrap()</code>中可以看到，这里会检查配置缓存文件是否存在，如果不存在就会去加载<code>.env</code>文件，否则就什么都不做。正好验证了前面的猜测：在生成配置缓存之后就不会去加载<code>.env</code>文件了。</p>
<p>（通过上面代码中的<code>$this-&gt;checkForSpecificEnvironmentFile($app);</code>往下跟踪，发现还可以使用<code>.env.APP_ENV</code>的方式定义跟随环境的配置信息，例如<code>.env</code>中如果定义了<code>APP_ENV=local</code>的话，在加载环境变量时也会尝试加载<code>.env.local</code>文件）。</p>
<h2 id="env应该什么时候被加载？"><a href="#env应该什么时候被加载？" class="headerlink" title=".env应该什么时候被加载？"></a>.env应该什么时候被加载？</h2><p>至此应该是真相大白了。那么<code>.env</code>应该什么时候被加载呢？</p>
<p>当然开发环境中不需要生成配置缓存，所以每次请求都会重新加载和解析<code>.env</code>文件并设置到<code>$_ENV</code>超全局变量中。生产环境中呢？</p>
<p>这时另一个猜想产生了：既然<code>bootstrap/cache/config.php</code>缓存文件中没有关于环境变量的信息，并且系统没有尝试加载<code>.env</code>文件，会不会有可能是已经把环境变量保存到了<code>config.php</code>缓存文件中了呢？如果真的是这样的话，那么<code>env()</code>函数就只能在<code>config/*.php</code>中的配置文件里面被调用（因为生成了配置缓存后就不再加载环境变量，程序的其它地方再去访问环境变量是得不到<code>.env</code>里面的信息的）。</p>
<p>全局搜索<code>env</code>(，猜对了，果然只在<code>config</code>文件夹里面的文件中使用这个函数，其它地方是没有调用过的。</p>
<p>综合整理一下上面的过程，也就是说如果在<code>.env</code>里面自定义了一个环境变量，就需要在<code>config</code>文件夹下的任意一个配置文件中把这个环境变量添加进去，这样生成的配置缓存中才会包含这个信息。</p>
<h2 id="环境变量的正确用法"><a href="#环境变量的正确用法" class="headerlink" title="环境变量的正确用法"></a>环境变量的正确用法</h2><p>好吧，只能说明是我认为是正确的用法。</p>
<p>首先肯定是要在自己的<code>.env</code>文件中定义这个环境变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.env</span><br><span class="line"></span><br><span class="line">APP_BASE_URL=test.com</span><br></pre></td></tr></table></figure>
<p>然后还需要把这个环境变量的定义写到<code>.env.example</code>文件中，以方便团队协作时其他成员能更好的理解你定义的这个变量。</p>
<p>然后很重要的一步，你还需要把这个环境变量写到配置文件中去。因为生成配置缓存时加载配置文件的过程是遍历整个<code>config</code>文件夹，所以你可以在<code>config</code>文件中任意新建一个PHP文件用来保存自己定义的环境变量，或者修改现有的任一配置文件。</p>
<p>就以新建配置文件为例吧，在<code>config</code>文件夹下新建<code>demo.php</code>文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">demo.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">return [</span><br><span class="line">	&apos;app_base_url&apos;  =&gt; env(&apos;APP_BASE_URL&apos;, &apos;default value&apos;),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>是的，我们是在这个配置文件中调用的<code>env()</code>函数。这样在生成配置缓存时就会在这里读取环境变量。</p>
<p>命令行执行；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan config:cache</span><br></pre></td></tr></table></figure>
<p>然后再打开<code>bootstrap/cache/config.php</code>文件，会发现其中多了一部分:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">config.php</span><br><span class="line"></span><br><span class="line">//.......</span><br><span class="line">&apos;demo&apos; =&gt; array(</span><br><span class="line">    	&apos;app_base_url&apos;  =&gt; &apos;test.com&apos;,</span><br><span class="line">	),</span><br></pre></td></tr></table></figure>
<p>至此自定义环境变量的过程已经圆满结束。当然因为使用了配置缓存，所以在程序中需要读取自定义环境变量的时候也就不能使用<code>env()</code>函数。内容存储在配置中，自然要用<code>config()</code>函数。</p>
<p>上面的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">route.php</span><br><span class="line"></span><br><span class="line">$_app_base_url = config(&apos;demo.app_base_url&apos;);</span><br><span class="line">Route::group([&apos;domain&apos; =&gt; &quot;u.&#123;$_app_base_url&#125;&quot;], function() &#123;</span><br><span class="line">    Route::get(&apos;/&apos;, function()&#123;</span><br><span class="line">        return &quot;TEST&quot;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>config()</code>函数使用点号作为分隔符，点号前面部分是配置文件名（例子中配置文件是<code>demo.php</code>，所以是<code>demo</code>），点号后面是配置项的键名（<code>app_base_url</code>）。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结就是如果你想同时使用自定义环境变量和配置缓存的话，你就需要自定义一个配置项来读取环境变量的值。</p>
<p>最后记得不要忘了把创建配置缓存命令写到你的构建脚本或自动部署中。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Laravel </category>
            
        </categories>
        
        
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[开启Fusion Drive功能教程 双硬盘 SSD+HDD]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/%E5%BC%80%E5%90%AFFusion%20Drive%E5%8A%9F%E8%83%BD%E6%95%99%E7%A8%8B%20%E5%8F%8C%E7%A1%AC%E7%9B%98%20SSD+HDD/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>废话不多说进入主题</p>
<p><img src="https://lh3.googleusercontent.com/-E0utAkBrw68/WJp0KJxr95I/AAAAAAAABYg/fg4_1VUTdq0/s0/2017-02-08_10-28-03.png" alt></p>
<blockquote>
<p>disk0 是用的 120g 三星ssd 固态硬盘<br>disk1 是用的 250g 机器自带的普通硬盘</p>
</blockquote>
<p><img src="https://lh3.googleusercontent.com/-R8GL5Cm9cMc/WJp0abZJ9MI/AAAAAAAABYk/oRlTT6-3-yQ/s0/2017-02-08_10-29-08.png" alt></p>
<p>1.开启Fusion Drive功能之前，先要把数据全部备份。</p>
<p><img src="https://lh3.googleusercontent.com/-22yQinjGFrQ/WJp0snqYIqI/AAAAAAAABYs/8LvjpzO5bgQ/s0/2017-02-08_10-30-22.png" alt></p>
<p>2.用系统启动光盘或者u盘启动电脑。</p>
<p><img src="https://lh3.googleusercontent.com/-7RdUviFxN98/WJp04GLOjZI/AAAAAAAABYw/6KVCkKBO5FI/s0/2017-02-08_10-31-07.png" alt></p>
<p>3.进入磁盘工具把2块硬盘都进行格式化</p>
<p><img src="https://lh3.googleusercontent.com/-TEUn4kf4Z50/WJp1ZegbCuI/AAAAAAAABY4/menESopf7v0/s0/2017-02-08_10-33-20.png" alt></p>
<p>4.退出磁盘工具，进入终端。</p>
<p>输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil list</span><br></pre></td></tr></table></figure></p>
<p>查看当前磁盘的详细信息</p>
<p><img src="https://lh3.googleusercontent.com/-TM1DhU3tVjc/WJp2R9Uy2ZI/AAAAAAAABZE/5r0reM3fbEQ/s0/2017-02-08_10-37-06.png" alt></p>
<p>5.合并磁盘</p>
<p>输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil cs create bla disk0 disk1</span><br></pre></td></tr></table></figure></p>
<p><img src="https://lh3.googleusercontent.com/-em2gG4BcWQA/WJp2lN41i5I/AAAAAAAABZI/DDjUR0LyBHQ/s0/2017-02-08_10-38-23.png" alt></p>
<p>这里可以看见最后一行 百分百的进度条。。。</p>
<p><img src="https://lh3.googleusercontent.com/-maQp1HMUN9A/WJqhrcq7ZFI/AAAAAAAABZk/Eqk6lvsq83Q/s0/2017-02-08_13-42-15.png" alt></p>
<p>画横线的地方显示正在创建逻辑盘。。。</p>
<p><img src="https://lh3.googleusercontent.com/-Flp1ZQVqu6Q/WJqhzS5hOcI/AAAAAAAABZo/aKnVGV3ZxnE/s0/2017-02-08_13-42-48.png" alt></p>
<p>这里显示逻辑盘已经创建成功</p>
<p>最后一行显示</p>
<p>Core Storage LVG UUID: <code>【BBC6AD77-ADF2-40EE-A1D0-68BFE4913966】</code></p>
<p>Finished CoreStorage operation</p>
<p><code>【】</code>中的字串之后还会用到，可以直接复制使用</p>
<p>6.再次输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil cs list</span><br></pre></td></tr></table></figure></p>
<p>查看逻辑磁盘状态</p>
<p><img src="https://lh3.googleusercontent.com/-55OmC1i9yOM/WJqiNghRqXI/AAAAAAAABZs/mxIFLTqrwSQ/s0/2017-02-08_13-44-32.png" alt></p>
<p>显示新的逻辑卷的容量和<code>id</code>，下面有组成逻辑卷的硬盘<code>id</code><br>秘书用的是<code>120+250</code>的硬盘，容量是<code>377.4G</code>，实际可用<code>375.2G</code></p>
<p>7.建立Fusion Drive</p>
<p>输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">diskutil coreStorage createVolume BBC6AD77-ADF2-40EE-A1D0-68BFE4913966 jhfs+ blub 375g</span><br><span class="line">diskutil coreStorage createVolume 【BBC6AD77-ADF2-40EE-A1D0-68BFE4913966】 jhfs+ blub 375g</span><br></pre></td></tr></table></figure></p>
<p>其中<code>【】</code>里面的id换成之前查到的自己的逻辑卷id，<code>【】</code>不要需要输入进去的。</p>
<p>建立的容量不能大于实际可用容量</p>
<p>8.退出终端 进入磁盘工具，看下是否已经成功开启Fusion Drive。</p>
<p><img src="https://lh3.googleusercontent.com/-V4J2mg_cGaY/WJqjk4iTFvI/AAAAAAAABZ8/Fj_iYgqMVvY/s0/2017-02-08_13-50-22.png" alt></p>
<p>9.接下来点 重新安装系统，后面就和普通安装没有任何区别了。</p>
<p><img src="https://lh3.googleusercontent.com/-Wbn3v2OHp_g/WJqjsnZ754I/AAAAAAAABaA/CQdziT0dQSo/s0/2017-02-08_13-50-54.png" alt><br><img src="https://lh3.googleusercontent.com/--cDPwpcrjdU/WJqj9ZiIjbI/AAAAAAAABaE/p3zyHD91k6k/s0/2017-02-08_13-52-01.png" alt><br><img src="https://lh3.googleusercontent.com/-m8qhXLJ-RoU/WJqkHAkXXmI/AAAAAAAABaM/Lp6Q0_zhXqk/s0/2017-02-08_13-52-39.png" alt></p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cloud9でLaravel5の環境構築]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Cloud9%E3%81%A7Laravel5%E3%81%AE%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<h2 id="プロジェクト作成"><a href="#プロジェクト作成" class="headerlink" title="プロジェクト作成"></a>プロジェクト作成</h2><p><img src="https://lh3.googleusercontent.com/-SXJRijcQ4F4/WJQPLCrNGrI/AAAAAAAAAzY/liQI8sZCmkU/s0/2017-02-03_14-03-41.png" alt><br><code>Workspace</code>名とテンプレートに<code>PHP</code>を選択します。<code>Hosted workspace</code>は<code>Private</code>でも<code>Public</code>でもどちらも構いませんが<code>Public</code>の場合はすべての人に公開されてしまいます。またフリー版では<code>Private</code>の<code>Workspace</code>は１つだけとなっています。</p>
<h2 id="Laravel5のプロジェクト作成"><a href="#Laravel5のプロジェクト作成" class="headerlink" title="Laravel5のプロジェクト作成"></a><code>Laravel5</code>のプロジェクト作成</h2><p>新しいタブでターミナルを開いてください。<br>以下のコマンドを実行してプロジェクトを作成してください。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rm README.md php.ini hello-world.php</span><br><span class="line">sudo composer self-update</span><br><span class="line">composer create-project laravel/laravel ./laravel --prefer-dist</span><br><span class="line">shopt -s dotglob</span><br><span class="line">mv laravel/* ./</span><br><span class="line">rm -rf laravel</span><br></pre></td></tr></table></figure>
<p>完了まで数分かかかります。</p>
<h2 id="Apacheのconf設定"><a href="#Apacheのconf設定" class="headerlink" title="Apacheのconf設定"></a>Apacheのconf設定</h2><p>以下のファイルを<code>vi</code>で開いて、<code>DocumentRoot</code>を以下に変更してください。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apache2/sites-enabled/001-cloud9.conf</span><br></pre></td></tr></table></figure>
<p>編集箇所</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DocumentRoot /home/ubuntu/workspace/public</span><br></pre></td></tr></table></figure>
<h2 id="アップデート"><a href="#アップデート" class="headerlink" title="アップデート"></a>アップデート</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer update</span><br></pre></td></tr></table></figure>
<h2 id="DB設定"><a href="#DB設定" class="headerlink" title="DB設定"></a>DB設定</h2><p>プロジェクトを作成した際に<code>MySQL</code>の<code>DB</code>が同時に作成されています。<br>まずは下記コマンドを実行して接続先のホスト名を確認しましょう。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql-ctl cli</span><br><span class="line">use c9;</span><br><span class="line">select @@hostname;　　←ホスト名が表示される</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<h2 id="LaravelのDB接続設定"><a href="#LaravelのDB接続設定" class="headerlink" title="LaravelのDB接続設定"></a><code>Laravel</code>の<code>DB</code>接続設定</h2><p> ワークスペースの直下に<code>「.env」</code>ファイルがありますが、エディタのエクスプローラーからは見えないです。（設定で表示可能かもしれませんが分かりませんでした。）ターミナルからファイルをvimで開いて編集してください。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DB_HOST=HOSTNAME　　←上で確認したホスト名をセット</span><br><span class="line">DB_DATABASE=c9　　　  ←初期値</span><br><span class="line">DB_USERNAME=USERNAME　←cloud9のユーザー名</span><br><span class="line">DB_PASSWORD=　　　　　　←初期値は空でOK</span><br></pre></td></tr></table></figure>
<h2 id="起動確認"><a href="#起動確認" class="headerlink" title="起動確認"></a>起動確認</h2><p>ひと通り設定は完了したので、<code>Apache</code>を起動して確認してみましょう。<br><code>Run</code>ボタンをクリックして画面下部に表示されたurlをクリックすると初期画面が表示されます。下記のように表示されていれば完了です。（<code>Laravel5</code>の場合）</p>
<p><img src="https://lh3.googleusercontent.com/-iYRTE3BEO3o/WJQQf8428QI/AAAAAAAAAzo/FSuSCDBxU50/s0/2017-02-03_14-09-19.png" alt></p>
<p>手軽に環境を作成したいと思いましたが、テンプレートが用意されていないとまだまだ手間がかかります。ここはもう少し改善を期待したいです。</p>
<p>また、<code>Laravel</code>のプロジェクトとしてアプリを利用するためには、権限の変更などまだいくつか設定が 必要になりますが、そこは下記リンクや他で色々と紹介されていますので参照してみてください。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Cloud9 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[解决升级 OS X EI Capitan 后 Wineskin 打包的游戏无法运行的问题]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/%E8%A7%A3%E5%86%B3%E5%8D%87%E7%BA%A7-OS-X-EI-Capitan-%E5%90%8E-Wineskin-%E6%89%93%E5%8C%85%E7%9A%84%E6%B8%B8%E6%88%8F%E6%97%A0%E6%B3%95%E8%BF%90%E8%A1%8C%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<!--excerpt-->
<p>此前苹果发布了 OS X 的新版本 EI Capitan，系统有更新当然是立马进行升级享受新鲜事物带来的快感了，但前几天想玩耍一局 Pro Evolution Soccer(实况足球)的时候，发现我深爱的游戏再也启动不起来了，和同样爱玩儿实况的同事交流之后发现情况大致有如下两种：</p>
<ol>
<li>双击 <code>.app</code> 文件，程序是可以打开的，但是窗口始终无法显示（我的电脑）；</li>
<li>双击 <code>.app</code> 文件，程序无法打开，系统提示 X11 无法打开，截图如下（同事的）：</li>
</ol>
<p><img src="https://lh3.googleusercontent.com/-QBgvDnnM1I8/WIF8A7QmcZI/AAAAAAAAAx4/9lYwjuvkybE/2017-01-20_11-54-59.png" alt></p>
<p>无法在绿茵场上尽情驰骋，这种事显然不能忍，立马去 <a href="http://wineskin.urgesoftware.com/" target="_blank" rel="noopener">Wineskin 官网</a>看了看，发现有一条关于 OS X EI Capitan 的新闻：</p>
<blockquote>
<p>Wineskin does not currently work correctly on El Capitan. The issue is being looked into, but I have no ETA for a fix. I’ll get a fix out as soon as I can.<br>Some people have been able to upgrade to the latest version of XQuartz, and change their wrappers to use XQuartz and not WineskinX11 and have gotten wrappers to work, but this method has not worked for everyone.<br>Please add to the discussion here if you are helping find a solution.</p>
</blockquote>
<p>又看到有一条新版本发布的新闻：</p>
<blockquote>
<p>I’ve released an update for Wineskin… version 2.6.1.<br>I think I’ve fixed all the El Capitan bugs and it should work fine on 10.6 - 10.11 now.<br>important point. This has to change how an engine is installed in a wrapper slightly. If you update a wrapper to 2.6.1 and it does not work right, please reinstall the engine in the wrapper. You can just use Change Engine and install the same one back in, but it will install it correctly for 2.6.1 and then things should work right. Newly made wrappers should have no issues.</p>
</blockquote>
<p>这说明官方发布的最新的 2.6.1 版本已经解决了该问题，那么剩下的问题就简单多了，我们只需要将 <code>Wineskin Wrapper</code> 给替换成官方发布的最新版本即可。</p>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><ol>
<li>在应用程序中找到需要修复的游戏，右键选择 <code>显示包内容</code>；</li>
<li>打开 <code>Wineskin.app</code>，选择 <code>advance</code>，记录下引擎版本号：</li>
</ol>
<p><img src="https://lh3.googleusercontent.com/-6iUQqxE4ehs/WIGN2RoMBgI/AAAAAAAAAyY/PZ-MapzWiSU/s0/2017-01-20_13-11-04.png" alt></p>
<ol start="3">
<li>下载最新版本的 <a href="http://wineskin.urgesoftware.com/tiki-index.php?page=Downloads" target="_blank" rel="noopener">Wineskin Winery</a>；</li>
<li>打开 <code>Wineskin Winery</code>，添加一个新的 <code>engine</code>，版本号最好与之前记录的版本号一致：</li>
</ol>
<p><img src="https://lh3.googleusercontent.com/-6GZhT7VGSoE/WIGOD7jQBmI/AAAAAAAAAyc/8Vsd_dVjhUA/s0/2017-01-20_13-11-58.png" alt></p>
<ol start="5">
<li>更新 <code>Wrapper Version</code> 至最新版，只要在 2.6.1 以上即代表已经使用了官方修复 OS X EI Capitan 问题的 <code>Wrapper</code>：</li>
</ol>
<p><img src="https://lh3.googleusercontent.com/-YqFjJh_LWPA/WIGOQFuz0TI/AAAAAAAAAyg/N5YYm23sKAc/s0/2017-01-20_13-12-47.png" alt></p>
<ol start="6">
<li>选择 <code>Create New Blank Wrapper</code>，填写游戏名称并选择 <code>Create</code>。如果有提示需要安装东西，都可以选择 <code>Cancel</code>；</li>
<li>创建成功后，将原游戏 <code>.app</code> 文件包内容中的 <code>Content/Resources/driver_c</code> 文件夹以及 <code>Content/Resources/system.reg</code>、<code>Content/Resources/user.reg</code>、<code>Content/Resources/userdef.reg</code> 这三个文件覆盖到我们新创建的 <code>Wrapper</code> 文件包内容中的 <code>Content/Resources/</code> 文件夹中，它们分别相当于 <code>Windows</code> 系统中的 C 盘和注册表；</li>
<li>再打开我们新创建的 <code>Wrapper</code> 文件包内容中的 <code>&#39;Wineskin.app&#39;</code>，选择 <code>advance</code>，然后选择程序的启动路径，即刚刚覆盖的 <code>driver_c</code> 文件夹中我们想要启动的 <code>exe</code> 程序：</li>
</ol>
<p><img src="https://lh3.googleusercontent.com/-D0qlGz7IKW4/WIGOfMRqr1I/AAAAAAAAAyk/rRYqm5pR1LA/s0/2017-01-20_13-13-48.png" alt></p>
<ol start="9">
<li>退回到我们在第 6 步中生成新 Wineskin Wrapper 的目录，当然现在它已经是一个完整的游戏程序了，双击运行它，然后 enjoy it!</li>
</ol>
<p>鉴于评论区有朋友反映下载 <code>engine</code> 和 <code>wrapper</code> 总是失败，所以现在将最新的 <code>engine</code> 和 <code>wrapper</code> 上传到网盘供大家下载：</p>
<ol start="10">
<li>Engine 1.7.52 <a href="http://pan.baidu.com/s/1bnoelND" target="_blank" rel="noopener">下载地址</a>，提取码：<code>ikhq</code>；</li>
<li>Wrapper 2.6.1 <a href="http://pan.baidu.com/s/1c0c6Qo4" target="_blank" rel="noopener">下载地址</a>，提取码：<code>v1dh</code>。</li>
</ol>
<p>下载后，将 <code>WS9Wine1.7.52.tar.7z</code> 这个文件放入 <code>~/Library/Application Support/Wineskin/Engines</code> 这个文件夹；将 <code>Wineskin-2.6.1.app.zip</code> 这个文件解压缩，得到 <code>Wineskin-2.6.1.app</code> 这个文件，将其放入 <code>~/Library/Application Support/Wineskin/Wrapper</code> 这个文件夹，然后重新打开上面第 3 步中下载的 <code>Wineskin Winery</code>，如果 <code>engine</code> 和 <code>wrapper</code> 都已经存在了，直接进行第 6 步的操作即可。</p>
<hr>
<p>再放上 <code>Wineskin Winery</code> 的网盘地址：</p>
<p>Wineskin Winery 1.7 <a href="http://pan.baidu.com/s/1hq8TO8G" target="_blank" rel="noopener">下载地址</a>，提取码：<code>dpdu</code>。</p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Nginxのエラーページをカスタマイズする方法]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Nginx/Nginx%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<blockquote>
<p>Nginxのデフォルトのエラーページは格好良くないし、Nginxを使ってることがバレバレです。それが嫌だったので以下の方法でカスタマイズしました。</p>
</blockquote>
<h2 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h2><blockquote>
<p>Nginxではエラーページのカスタマイズにはerror_pageディレクティブを使います。<br>カスタマイズの基本的な方法は、custom_404.htmlを作って、nginxの設定ファイルを以下の様な感じにします。<br>これで、Nginxを再起動して、存在しないファイルへリクエストするとcustom_404.htmlが帰ってくるようになります。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">    # 中略</span><br><span class="line"></span><br><span class="line">    error_page 404 /custom_404.html;</span><br><span class="line">    location = /custom_404.html &#123;</span><br><span class="line">        root /opt/nginx/html;</span><br><span class="line">        internal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 中略</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="応用"><a href="#応用" class="headerlink" title="応用"></a>応用</h2><blockquote>
<p>以下では、よりより実践的な例を紹介します。</p>
</blockquote>
<blockquote>
<p>IP直打ちでのアクセスは全てエラーページを表示</p>
</blockquote>
<blockquote>
<p>IPアドレスを直接入力してアクセスしてきた場合や想定外のホスト名でアクセスしてきた場合に常に<code>custom_404.html</code>を表示したければ以下の様にします。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    error_page 404 /custom_404.html;</span><br><span class="line">    location / &#123;</span><br><span class="line">        return 404;</span><br><span class="line">    &#125;</span><br><span class="line">    location = /custom_404.html &#123;</span><br><span class="line">        root /opt/nginx/html;</span><br><span class="line">        internal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>どんなエラーが発生しても404ページを返す</p>
<p>実際に発生しているエラーが403だろうが503だろうが、ユーザーには404エラーが発生しているように見せかけます。<br>下の例では400, 401, 403, 500, 502, 503のいずれが発生してもクライアントに返すHTTPステータスコードを404に書き換え、custom_404.htmlを返します。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name example.com;</span><br><span class="line">    error_page 400 401 403 404 500 502 503 =404 /custom_404.html;</span><br><span class="line">    location = /custom_404.html &#123;</span><br><span class="line">        root /opt/nginx/html;</span><br><span class="line">        internal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>管理画面を隠す</p>
<p>特定のIP以外から管理画面へアクセスされた時は404画面を出します。<br>この例では<code>192.168.0.1</code>からの管理画面へのリクエストは許可し、それ以外の場合は404ステータスとcustom_404.htmlを返します。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Nginx </category>
            
        </categories>
        
        
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[江南云服务正式上线]]></title>
      <url>https://github.jiangnan.pw/%E4%BD%9C%E5%93%81%E5%B1%95%E7%A4%BA/%E6%B1%9F%E5%8D%97%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%AD%A3%E5%BC%8F%E4%B8%8A%E7%BA%BF/</url>
      <content type="html"><![CDATA[<p>江南云-提供基于百度云，天翼云(正在开发中Y(^_^)Y)的云存储服务，包括图片，音乐，视频，文件的云存储下载服务。</p>
<ul>
<li>提供百度云，天翼云本身不支持的迅雷等工具直接下载的功能。</li>
<li>采用用户本地存储TOKEN的方式进行授权，充分保证用户的个人隐私</li>
<li>提供图片，音视频等流媒体的直接外链功能，从此站长再也不用费心找图床。</li>
</ul>
<p><img src="https://lh3.googleusercontent.com/-qqlLrJo8JS4/WHRseojYN2I/AAAAAAAAAuQ/lXV-fkSg97M/s0/2017-01-10_14-09-12.png" alt="江南云首页"><br><img src="https://lh3.googleusercontent.com/-tQF7SvGlpMk/WHRudf1irvI/AAAAAAAAAuw/YwENVxgYmk0/s0/2017-01-10_14-17-39.png" alt="授权代码获取"><br><img src="https://lh3.googleusercontent.com/-fIOPEh7rQ1E/WHRus4ZSdeI/AAAAAAAAAu0/Ib9kRzuSxHM/s0/2017-01-10_14-18-42.png" alt="江南云文件管理"><br><img src="https://lh3.googleusercontent.com/-dagoHUPxzQQ/WHRvn18eX8I/AAAAAAAAAvA/2h1_xL5NPW8/s0/2017-01-10_14-22-39.png" alt="江南云侧边栏"></p>
]]></content>
      
        <categories>
            
            <category> 作品展示 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 江南云 </tag>
            
            <tag> 作品展示 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Laravel5导入自定义函数和类的方法]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/Laravel/Laravel5%E5%AF%BC%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E5%92%8C%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>我们的应用里经常会有一些全局都可能会用的函数，我们应该怎么放置它会比较好呢？以下有一种推荐的方式：<br><!--excerpt--></p>
<h2 id="导入自定义函数"><a href="#导入自定义函数" class="headerlink" title="导入自定义函数"></a>导入自定义函数</h2><p>我们的应用里经常会有一些全局都可能会用的函数，我们应该怎么放置它会比较好呢？以下有一种推荐的方式：</p>
<ol>
<li>创建文件 <code>app/helpers.php</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">// 示例函数</span><br><span class="line">function foo() &#123;</span><br><span class="line">    return &quot;foo&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>修改项目 <code>composer.json</code></li>
</ol>
<p>在项目 composer.json 中 autoload 部分里的 files 字段加入该文件即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    &quot;autoload&quot;: &#123;</span><br><span class="line">        &quot;files&quot;: [</span><br><span class="line">            &quot;app/helpers.php&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后运行:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer dump-autoload</span><br></pre></td></tr></table></figure></p>
<p>OK，然后你就可以在任何地方用到 <code>app/helpers.php</code> 中的函数了。</p>
<h2 id="导入自定义类"><a href="#导入自定义类" class="headerlink" title="导入自定义类"></a>导入自定义类</h2><p>比如说我要加载一个名字是BaiduPCS.php类文件</p>
<p>修改项目 <code>composer.json</code></p>
<p>在项目 composer.json 中 autoload 部分里的 classmap 字段加入该文件所在的文件夹即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&quot;autoload&quot;: &#123;</span><br><span class="line">    &quot;classmap&quot;: [</span><br><span class="line">        &quot;database&quot;,</span><br><span class="line">        &quot;app/DDL/Classes&quot;  &lt;== 就是这里</span><br><span class="line">    ],</span><br><span class="line">    &quot;files&quot;: [</span><br><span class="line">        &quot;app/DDL/Functions/functions.php&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;psr-4&quot;: &#123;</span><br><span class="line">        &quot;App\\&quot;: &quot;app/&quot;,</span><br><span class="line">        &quot;DDL\\&quot;:&quot;app/DDL/&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>然后运行:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer dump-autoload</span><br></pre></td></tr></table></figure></p>
<p>OK，然后你就可以在你要使用该类的地方添加以下代码来使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use BaiduPCS;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> Laravel </category>
            
        </categories>
        
        
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[常用图床及自建图床方法汇总]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/%E5%B8%B8%E7%94%A8%E5%9B%BE%E5%BA%8A%E5%8F%8A%E8%87%AA%E5%BB%BA%E5%9B%BE%E5%BA%8A%E6%96%B9%E6%B3%95%E6%B1%87%E6%80%BB/</url>
      <content type="html"><![CDATA[<p>国内图床的中流砥柱，速度非常快，服务也较为稳定，目前还支持了 HTTPS ，同时有大量的第三方工具……<br><!--excerpt--></p>
<h2 id="公共图床"><a href="#公共图床" class="headerlink" title="公共图床"></a>公共图床</h2><h3 id="微博图床"><a href="#微博图床" class="headerlink" title="微博图床"></a>微博图床</h3><p>国内图床的中流砥柱，速度非常快，服务也较为稳定，目前还支持了 HTTPS ，同时有大量的第三方工具方便使用，缺点是批量上传比较麻烦。</p>
<ul>
<li><a href="http://photo.weibo.com/photos/upload" target="_blank" rel="noopener">官方上传地址</a></li>
<li><a href="https://chrome.google.com/webstore/detail/%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E5%9B%BE%E5%BA%8A/fdfdnfpdplfbbnemmmoklbfjbhecpnhf/related" target="_blank" rel="noopener">新浪微博图床 Chrome 插件</a></li>
<li><a href="https://chrome.google.com/webstore/detail/%E5%9B%B4%E8%84%96%E6%98%AF%E4%B8%AA%E5%A5%BD%E5%9B%BE%E5%BA%8A/pngmcllbdfgmhdgnnpfaciaolgbjplhe/related?hl=zh-CN" target="_blank" rel="noopener">围脖图床 Chrome 插件（网页版不可用，Firefox 版在附加组件中搜索安装即可）</a></li>
</ul>
<h3 id="imgur"><a href="#imgur" class="headerlink" title="imgur"></a>imgur</h3><p>09年就成立了的国外老牌图床，支持https，理论上不限制大小，还有邮件发图、视频转 GIF 、URL 上传等功能，很强大，可惜间歇性被墙，就算没被墙国内访问也很慢，面向国外的站点使用倒很合适。</p>
<p>地址：<a href="https://imgur.com/" target="_blank" rel="noopener">https://imgur.com</a></p>
<h3 id="sm-ms"><a href="#sm-ms" class="headerlink" title="sm.ms"></a>sm.ms</h3><p>支持https，有 API ，图片要求大小在 5MB 以下，一次上传不得超过10张，维护者是 <a href="https://ttt.tt/" target="_blank" rel="noopener">通天塔</a> 的站长。主站 <a href="https://sm.ms/" target="_blank" rel="noopener">https://sm.ms</a> 目前用的是阿里云新加坡的机器，而上传的图片则会被存储到使用阿里云香港的 <a href="https://ooo.0o0.ooo/" target="_blank" rel="noopener">https://ooo.0o0.ooo</a> 中，因此速度还是很不错的。<a id="more"></a></p>
<p>地址：<a href="https://sm.ms/" target="_blank" rel="noopener">https://sm.ms</a></p>
<p>API：<a href="https://sm.ms/doc/" target="_blank" rel="noopener">https://sm.ms/doc/</a></p>
<h3 id="otar-im"><a href="#otar-im" class="headerlink" title="otar.im"></a>otar.im</h3><p>这个网站本身并不是一个图床，但却做到了一个更比三个强，整合上文提到的微博图床、imgur、sm.ms 到一个页面中，非常方便实用。然而最近使用时提示未知错误上传失败，不知是否停止维护了。</p>
<p>地址：<a href="http://upload.otar.im/" target="_blank" rel="noopener">http://upload.otar.im/</a></p>
<h3 id="V2EX-图片库"><a href="#V2EX-图片库" class="headerlink" title="V2EX 图片库"></a>V2EX 图片库</h3><p>程序员社区 v2ex 推出的付费图床服务，由于博主没有需求所以未付费使用过，效果不明。</p>
<p>地址：<a href="https://www.v2ex.com/i/about" target="_blank" rel="noopener">https://www.v2ex.com/i/about</a></p>
<h3 id="LightPic"><a href="#LightPic" class="headerlink" title="LightPic"></a>LightPic</h3><p>使用其自己开发的系统，站点规则中写明了不保证图片可以永久存储，似乎使用了 CloudFlare 非中国版的 CDN ，因此支持 https ，但是 CF 在国内部分地区的访问效果很堪忧。</p>
<p>地址：<a href="https://lightpic.info/" target="_blank" rel="noopener">https://lightpic.info</a></p>
<h3 id="picwindow"><a href="#picwindow" class="headerlink" title="picwindow"></a>picwindow</h3><p>国外图床，号称长久而稳定的储存，图片要求大小在 10MB 以下，国内访问速度一般但可以接受，缺点是上传时有些慢，且不支持 HTTPS ，不过他的远程上传（其实也就是通过 URL 直接上床图片）的功能还是很好用的。</p>
<p>地址：<a href="http://www.picwindow.com/" target="_blank" rel="noopener">http://www.picwindow.com/</a></p>
<h3 id="贴图库"><a href="#贴图库" class="headerlink" title="贴图库"></a>贴图库</h3><p>早年的神级图床，可惜后来因为某种原因关停，恢复后暂时使用了 kekaoyun 这个域名，现在已经切换回了原域名，但是也从关停前的永久免费变为了6个月免费，也就是免费存储的图片只保存六个月，并提供了付费的商业选项。速度没得说，但是不适合博客这样的站点使用。</p>
<p>地址：<a href="http://www.tietuku.com/" target="_blank" rel="noopener">http://www.tietuku.com/</a></p>
<p>费用详情：<a href="http://www.tietuku.com/open" target="_blank" rel="noopener">http://www.tietuku.com/open</a></p>
<h3 id="萝莉图床"><a href="#萝莉图床" class="headerlink" title="萝莉图床"></a>萝莉图床</h3><p>也是早年一个很好用的图床，但是现在需要邀请注册才能使用。</p>
<p>地址：<a href="http://loli.io/" target="_blank" rel="noopener">http://loli.io/</a></p>
<h2 id="自建图床"><a href="#自建图床" class="headerlink" title="自建图床"></a>自建图床</h2><h3 id="七牛、又拍云等云存储"><a href="#七牛、又拍云等云存储" class="headerlink" title="七牛、又拍云等云存储"></a>七牛、又拍云等云存储</h3><p>这些服务商其实是做 CDN 和云存储的，但是由于有一定的免费存储及流量额度，所以也有很多人拿来做自己博客的图床，速度可以和微博图床媲美，各种以其为基础开发的第三方工具用起来也很顺手，缺点是大部分都不支持 https ，同时注册时要求上传身份证信息挺麻烦的。下面推荐几个具有代表性的服务商及第三方工具：</p>
<p>服务商：</p>
<ul>
<li>七牛：<a href="http://www.qiniu.com/" target="_blank" rel="noopener">http://www.qiniu.com/</a></li>
<li>又拍云：<a href="https://www.upyun.com/index.html" target="_blank" rel="noopener">https://www.upyun.com/index.html</a></li>
</ul>
<p>工具：</p>
<ul>
<li>iPic (Mac only)：<a href="http://i.toolinbox.net/iPic/iPicUploader.html" target="_blank" rel="noopener">http://i.toolinbox.net/iPic/iPicUploader.html</a></li>
<li>yotuku：<a href="http://yotuku.cn/" target="_blank" rel="noopener">http://yotuku.cn/</a></li>
<li>PHP版七牛图床：<a href="https://github.com/4679/qiniu-picbed" target="_blank" rel="noopener">https://github.com/4679/qiniu-picbed</a></li>
<li>Get Link：<a href="https://github.com/int64ago/getlink" target="_blank" rel="noopener">https://github.com/int64ago/getlink</a></li>
</ul>
<h3 id="树洞外链"><a href="#树洞外链" class="headerlink" title="树洞外链"></a>树洞外链</h3><blockquote>
<p>树洞外链是一款免费开源的PHP外链网盘系统，界面简洁友好，支持七牛、本地、远程、阿里云OSS、又拍云五种储存方式，支持多用户系统，多上传方案策略。</p>
</blockquote>
<p>官方给出了这样的说明，实际使用下来也确实不错，有文档、安装方便也比较稳定，但存在着一些小 Bug ，小站点用来自建图床还是很合适的。</p>
<p>官网：<a href="https://yun.aoaoao.me/" target="_blank" rel="noopener">https://yun.aoaoao.me/</a></p>
<p>Github：<a href="https://github.com/HFO4/shudong-share" target="_blank" rel="noopener">https://github.com/HFO4/shudong-share</a></p>
<h3 id="Lychee"><a href="#Lychee" class="headerlink" title="Lychee"></a>Lychee</h3><p>一款开源的图片管理系统，实际上也可以用作图床，一直在更新，自身功能很强大，还支持二次开发插件及扩展来丰富功能，此外这套系统也支持 Docker 。</p>
<p>GIthub：<a href="https://github.com/electerious/Lychee" target="_blank" rel="noopener">https://github.com/electerious/Lychee</a></p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 开源 </tag>
            
            <tag> 图床 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MacOSX10.11开启任意显示器HiDPI方法]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E6%8A%80%E5%B7%A7/MacOSX10-11%E5%BC%80%E5%90%AF%E4%BB%BB%E6%84%8F%E6%98%BE%E7%A4%BA%E5%99%A8HiDPI%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>MacOSX10.11开启任意显示器HiDPI方法<br><!--excerpt--></p>
<blockquote>
<p>研究了下，其实没怎么变化。Overrides文件夹目录位置变了而已。<br>本人开启HiDPI现在更主要是为了截图截出2x的效果，实际调整分辨率的是另一个小显示器~已经很久用不到HiDPI的真实意义啦</p>
</blockquote>
<h2 id="对于权限问题的补充"><a href="#对于权限问题的补充" class="headerlink" title="对于权限问题的补充"></a>对于权限问题的补充</h2><p>10.11系统权限设置又改动，一些系统文件只有“系统”有权限读写，首先要关闭这个权限：<br>开机按住 <strong>command ＋ R</strong>，进入恢复模式，然后在“终端”中输入“csrutil disable”关闭权限。如果需要打开，则csrutil enable。<br>这是在知乎上看到相同的问题，别人提到的。LZ好像没遇到过这种情况，如果有人遇到同样的权限问题，这样解决就好了。</p>
<h3 id="对于权限问题的补充-1"><a href="#对于权限问题的补充-1" class="headerlink" title="对于权限问题的补充"></a>对于权限问题的补充</h3><ol>
<li><p>开启HiDPI<br>打开终端 键入<br>sudo defaults write /Library/Preferences/com.apple.windowserver DisplayResolutionEnabled -bool YES<br>回车后，输入当前系统管理员的密码，继续回车确认。</p>
</li>
<li><p>获取你的显示器的两个 ID:<br>DisplayVendorID和DisplayProductID<br>打开终端, 命令分别是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ioreg -l | grep &quot;DisplayVendorID&quot;</span><br><span class="line">ioreg -l | grep &quot;DisplayProductID&quot;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>OK.在桌面上新建一个文件夹,名字格式是:DisplayVendorID-XXXX,其中XXXX是你的DisplayVendorID的16进制值小写.<br>于是,我会新建一个 DisplayVendorID-XXXX的文件夹,然后在这个文件夹里面新建一个空白文件.名字格式是<br>DisplayProductID-YYYY,自然YYYY就是你的DisplayProductID的16进制了.<br>我新建的文件是 DisplayProductID-YYYY.<br>最好下载我提供的模板编辑.<br>相信你不一定能找到个合适的进制转换工具，我从网上找到了一个很好用的flash，并把它放到了自己的服务器里，<br>大家如有需要随时可以去用<br>在线进制转换器<br>建议使用PlistPro工具编辑，方便快捷。.<br><strong>范例:</strong></p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>DisplayProductID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">integer</span>&gt;</span>10496<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>DisplayVendorID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">integer</span>&gt;</span>8547<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>scale-resolutions<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAKAAAABkAAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAUAAAADIAAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAKAAAABDgAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAUAAAACHAAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAHgAAABDgAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAPAAAACHAAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAGkAAABBoAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAANIAAACDQAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAGQAAAA4QAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAMgAAABwgAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAFoAAAA4QAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAALQAAABwgAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAINAAAA4QAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">                AAAQaAAABwgAAAABACAAAA==</span><br><span class="line">                <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>建议下载本帖子中的附件。包含本范例。</p>
<p>最后面那一坨,和以及里面的data如何来的<br>比如我想使用1600900这个HiDPI,那么我就需要生成两个分辨率,其中一个是1600900,一个是其双倍,3200*1800.<br>1600,900两个值的16进制是00000640 00000384 ;<br>3200,1800两个值的16进制是00000C80 00000708;<br>后面加上 00000001 00200000<br>于是会得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">00000640 00000384 00000001 00200000</span><br><span class="line">00000C80 00000708 00000001 00200000</span><br></pre></td></tr></table></figure></p>
<p>用附件中的PlistPro编辑这个DisplayProductID-YYYY,计算并填写你想要的分辨率.<br>最后,把这个 DisplayVendorID-XXXX 文件夹,</p>
<p>拷贝到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/System/Library/Displays/Contents/Resources/Overrides/</span><br></pre></td></tr></table></figure></p>
<p>(10.10及以下是 /System/Library/Displays/Overrides/ )<br>重启系统就可以看到了.可以安装RDM切换,在任务栏,方便快捷.<br>各位可以根据自己的屏幕规格来添加.</p>
<p>范例中，设定的分辨率是<br>2560x1600 2x (16:10)<br>2560x1080 2x (21:9)<br>1920x1080 2x (16:9)<br>1680x1050 2x (16:10)<br>1600x900 2x(16:9)<br>1440x900 2x(16:10)<br>2100x900 2x(21:9)</p>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac技巧 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mac技巧 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[禁止WordPress头部加载s.w.org]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/WordPress/%E7%A6%81%E6%AD%A2WordPress%E5%A4%B4%E9%83%A8%E5%8A%A0%E8%BD%BDs-w-org/</url>
      <content type="html"><![CDATA[<p>WordPress在头部添加dns-prefetch，应该是为了从s.w.org预获取表情和头像，目的是提高网页加载速度 ，但s.w.org国内根本无法访问，什么预获取、什么提高速度，都是泡影，不仅没用处，反而可能会影响速度，那就禁止它。<br><!-- excerpt --><br><img src="https://dl.dropbox.com/s/5et1y0kkomei4wx/wordpress1.jpg?dl=0" alt="wordpress"></p>
<p>升级到WordPress 4.6之后，有童鞋发现头部加载了一个:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&apos;dns-prefetch&apos; href=&apos;//s.w.org&apos;&gt;</span><br></pre></td></tr></table></figure></p>
<p>WordPress在头部添加dns-prefetch，应该是为了从s.w.org预获取表情和头像，目的是提高网页加载速度 ，但s.w.org国内根本无法访问，什么预获取、什么提高速度，都是泡影，不仅没用处，反而可能会影响速度，那就禁止它。</p>
<h2 id="将下面的代码添加到主题functions-php模板中："><a href="#将下面的代码添加到主题functions-php模板中：" class="headerlink" title="将下面的代码添加到主题functions.php模板中："></a>将下面的代码添加到主题functions.php模板中：</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">remove_action( &apos;wp_head&apos;, &apos;wp_resource_hints&apos;, 2 );</span><br></pre></td></tr></table></figure>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function remove_dns_prefetch( $hints, $relation_type ) &#123;</span><br><span class="line">if ( &apos;dns-prefetch&apos; === $relation_type ) &#123;</span><br><span class="line">return array_diff( wp_dependencies_unique_hosts(), $hints );</span><br><span class="line">&#125;</span><br><span class="line">return $hints;</span><br><span class="line">&#125;</span><br><span class="line">add_filter( &apos;wp_resource_hints&apos;, &apos;remove_dns_prefetch&apos;, 10, 2 );</span><br></pre></td></tr></table></figure>
<p>方法二貌似兼容性更好些。<br>附带一个禁止加载表情代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Remove emoji script</span><br><span class="line">remove_action( &apos;wp_head&apos;, &apos;print_emoji_detection_script&apos;, 7 );</span><br><span class="line">remove_action( &apos;wp_print_styles&apos;, &apos;print_emoji_styles&apos; );</span><br><span class="line">add_filter( &apos;emoji_svg_url&apos;, &apos;__return_false&apos; );</span><br></pre></td></tr></table></figure></p>
<p>参考：<a href="https://wordpress.org/support/topic/remove-the-new-dns-prefetch-code/" target="_blank" rel="noopener">https://wordpress.org/support/topic/remove-the-new-dns-prefetch-code/</a></p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> WordPress </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> 技术分享 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WordPress 后台文件管理插件：FileBrowser]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/WordPress/WordPress-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%8F%92%E4%BB%B6%EF%BC%9AFileBrowser/</url>
      <content type="html"><![CDATA[<p>WordPress 后台文件管理插件：FileBrowser<br><!-- excerpt --><br><img src="https://dl.dropbox.com/s/ju6fp7yj13acoms/wordpress.jpg?dl=0" alt="wordpress"></p>
<p>WordPress 后台文件管理插件：FileBrowser</p>
<p>wordpress本身没有像dedecms那样的在线文件管理功能，一般的文件管理都得通过FTP来实现，把文件下载下来，然后再编辑上传，很麻烦，而且有的空间根本不支持FTP，所以我们可以使用wordpress后台文件管理插件：FileBrowser。</p>
<p><a href="https://wordpress.org/plugins/filebrowser/" target="_blank" rel="noopener">原版下载地址</a><br><a href="http://pan.baidu.com/share/link?shareid=374434&amp;uk=757737247" target="_blank" rel="noopener">汉化版下载地址</a></p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> WordPress </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> plugins </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[获取WordPress当前分类文章所有标签]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/WordPress/%E8%8E%B7%E5%8F%96WordPress%E5%BD%93%E5%89%8D%E5%88%86%E7%B1%BB%E6%96%87%E7%AB%A0%E6%89%80%E6%9C%89%E6%A0%87%E7%AD%BE/</url>
      <content type="html"><![CDATA[<p>如果需要在分类列表页面，显示当前分类文章中添加的所有标签，方便读者阅读自己喜欢的内容，下面的代码可以帮你实现这个功能。<br>获取WordPress当前分类文章所有标签<br><a id="more"></a></p>
<p>首先，在主题functions.php模板文件中添加以下函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">function get_category_tags($args) &#123;</span><br><span class="line">    global $wpdb;</span><br><span class="line">    $tags = $wpdb-&gt;get_results</span><br><span class="line">    (&quot;</span><br><span class="line">        SELECT DISTINCT terms2.term_id as tag_id, terms2.name as tag_name</span><br><span class="line">        FROM</span><br><span class="line">            $wpdb-&gt;posts as p1</span><br><span class="line">            LEFT JOIN $wpdb-&gt;term_relationships as r1 ON p1.ID = r1.object_ID</span><br><span class="line">            LEFT JOIN $wpdb-&gt;term_taxonomy as t1 ON r1.term_taxonomy_id = t1.term_taxonomy_id</span><br><span class="line">            LEFT JOIN $wpdb-&gt;terms as terms1 ON t1.term_id = terms1.term_id,</span><br><span class="line">            $wpdb-&gt;posts as p2</span><br><span class="line">            LEFT JOIN $wpdb-&gt;term_relationships as r2 ON p2.ID = r2.object_ID</span><br><span class="line">            LEFT JOIN $wpdb-&gt;term_taxonomy as t2 ON r2.term_taxonomy_id = t2.term_taxonomy_id</span><br><span class="line">            LEFT JOIN $wpdb-&gt;terms as terms2 ON t2.term_id = terms2.term_id</span><br><span class="line">        WHERE</span><br><span class="line">            t1.taxonomy = &apos;category&apos; AND p1.post_status = &apos;publish&apos; AND terms1.term_id IN (&quot;.$args[&apos;categories&apos;].&quot;) AND</span><br><span class="line">            t2.taxonomy = &apos;post_tag&apos; AND p2.post_status = &apos;publish&apos;</span><br><span class="line">            AND p1.ID = p2.ID</span><br><span class="line">        ORDER by tag_name</span><br><span class="line">    &quot;);</span><br><span class="line">    $count = 0;</span><br><span class="line">    if($tags) &#123;</span><br><span class="line">        foreach ($tags as $tag) &#123;</span><br><span class="line">            $mytag[$count] = get_term_by(&apos;id&apos;, $tag-&gt;tag_id, &apos;post_tag&apos;);</span><br><span class="line">            $count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      $mytag = NULL;</span><br><span class="line">    &#125;</span><br><span class="line">    return $mytag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编译：<a href="http://www.ludou.org/wordpress-get-tags-specific-to-category.html" target="_blank" rel="noopener">http://www.ludou.org/wordpress-get-tags-specific-to-category.html</a><br>源代码出自：<a href="https://wordpress.org/support/topic/get-tags-specific-to-category" target="_blank" rel="noopener">https://wordpress.org/support/topic/get-tags-specific-to-category</a></p>
<p>其次，将下面调用输出代码，添加到主题archive.php模板适当位置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $cat= single_cat_title(&apos;&apos;, false);</span><br><span class="line">    $args = array( &apos;categories&apos; =&gt; get_cat_ID($cat));</span><br><span class="line">    $tags = get_category_tags($args);</span><br><span class="line">    $content .= &quot;&lt;ul class=&apos;cat-tag&apos;&gt;&quot;;</span><br><span class="line">    if(!empty($tags)) &#123;</span><br><span class="line">        foreach ($tags as $tag) &#123;</span><br><span class="line">            $content .= &quot;&lt;li&gt;&lt;a href=\&quot;&quot;.get_tag_link($tag-&gt;term_id).&quot;\&quot;&gt;&quot;.$tag-&gt;name.&quot;&lt;/a&gt;&lt;/li&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $content .= &quot;&lt;/ul&gt;&quot;;</span><br><span class="line">    echo $content;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>个人感觉放到头部调用函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php get_header(); ?&gt;</span><br></pre></td></tr></table></figure></p>
<p>下面比较合适。<br>最后，再适当加上样式即可：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.cat-tag</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cat-tag</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> WordPress </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> 技术分享 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Alfred实现七牛上传文件]]></title>
      <url>https://github.jiangnan.pw/%E8%8B%B9%E6%9E%9C%E7%9B%B8%E5%85%B3/Mac%E8%BD%AF%E4%BB%B6/Alfred%E5%AE%9E%E7%8E%B0%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>alfred-workflow-qshell<br>qshell 是基于七牛API参考手册实现的一个方便开发者测试和使用七牛API服务的命令行工具。<br><!--excerpt--></p>
<h2 id="alfred-workflow-qshell"><a href="#alfred-workflow-qshell" class="headerlink" title="alfred-workflow-qshell"></a>alfred-workflow-qshell</h2><blockquote>
<p>qshell 是基于七牛API参考手册实现的一个方便开发者测试和使用七牛API服务的命令行工具。</p>
</blockquote>
<p>alfred-workflow-qshell 是一个配合七牛开发者工具 <a href="http://developer.qiniu.com/code/v6/tool/qshell.html" target="_blank" rel="noopener">qshell</a> 使用的 Alfred workflow。</p>
<p>alfred-workflow-qshell 使用可视化流程后台执行 <code>qshell</code> 命令行，易用高效。</p>
<h2 id="功能-amp-特点"><a href="#功能-amp-特点" class="headerlink" title="功能 &amp; 特点"></a>功能 &amp; 特点</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul>
<li>支持多文件上传</li>
<li>支持上传文件添加前缀</li>
<li>获取空间文件外链</li>
<li>查看空间文件基本信息</li>
<li>移动、复制、删除、重命名</li>
<li>预览、下载空间文件</li>
<li>完善的文件操作反馈（通知、错误等）</li>
</ul>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>curl 下载文件</li>
<li>不支持文件夹上传<br>要求空间的文件名为不能为空或全为空格</li>
</ul>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><ul>
<li>默认关键字 <code>fput</code> 搜索本地单个文件，上传文件</li>
<li>搜索文件时使用 <strong>Buffer</strong> 功能进行文件多选，上传多文件（<a href="https://github.com/onestark/better-series/blob/master/better-workflow.md" target="_blank" rel="noopener">Buffer 的使用</a>）</li>
<li>选中一或多个文件，调出 <strong>Actions</strong> 文件操作菜单，上传文件</li>
</ul>
<h3 id="操作文件"><a href="#操作文件" class="headerlink" title="操作文件"></a>操作文件</h3><ul>
<li>默认关键字 <code>fstat</code> 搜索空间文件</li>
<li>移动、复制、删除、重命名、外链、信息、预览、下载</li>
</ul>
<h2 id="安装-amp-配置"><a href="#安装-amp-配置" class="headerlink" title="安装 &amp; 配置"></a>安装 &amp; 配置</h2><p>要求：<strong>qshell</strong>、<strong>Alfred with Powerpack</strong></p>
<h3 id="1-qshell"><a href="#1-qshell" class="headerlink" title="1. qshell"></a>1. <a href="http://developer.qiniu.com/code/v6/tool/qshell.html" target="_blank" rel="noopener">qshell</a></h3><p>或前往 <a href="https://github.com/qiniu/qshell" target="_blank" rel="noopener">GitHub</a></p>
<p>安装：只需要下载 zip 包之后解压即可使用。Mac 64 位系统只需要解压后的文件 <code>qshell_darwin_amd64</code>。把此文件放到 <code>/usr/local/bin</code> 目录。</p>
<p>配置：从七牛的后台的账号设置中获取 <strong>AccessKey</strong> 和 <strong>SecretKey</strong>。配置本地 qshell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 设置密钥</span><br><span class="line">qshell account [AccessKey] [SecretKey]</span><br><span class="line"># 查看设置</span><br><span class="line">qshell account</span><br></pre></td></tr></table></figure>
<p>注意：上面的设置命令不需要输入方括号 <code>[]</code>。</p>
<p>配置 qshell 完毕后会生成 <code>~/.qshell</code> 文件夹，其中 <code>account.json</code> 文件保存了 AccessKey 和 SecretKey 信息。</p>
<h3 id="2-Alfred"><a href="#2-Alfred" class="headerlink" title="2. Alfred"></a>2. <a href="https://www.alfredapp.com/" target="_blank" rel="noopener">Alfred</a></h3><p>下载后缀名为 <code>.alfredworkflow</code> 的安装包安装即可。</p>
<p>注意：Alfred 需要购买 <a href="https://www.alfredapp.com/powerpack/buy/" target="_blank" rel="noopener">Powerpack</a> 才能解锁 workflows 功能。</p>
<h2 id="Todo"><a href="#Todo" class="headerlink" title="Todo"></a>Todo</h2><ul>
<li>[x] account，显示当前用户的 AccessKey 和 SecretKey</li>
<li>[x] fput，以文件表单的方式上传一个文件</li>
<li>[x] stat，查询七牛空间中一个文件的基本信息</li>
<li>[x] delete，删除七牛空间中的一个文件</li>
<li>[x] move，移动或重命名七牛空间中的一个文件</li>
<li>[x] copy，复制七牛空间中的一个文件</li>
<li>[x] 查新基本信息时可以获取文件外链</li>
<li>[x] 预览功能</li>
<li>[x] 下载功能</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 苹果相关 </category>
            
            <category> Mac软件 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Alfred </tag>
            
            <tag> Mac软件 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[自动从其它站点RSS抓取文章]]></title>
      <url>https://github.jiangnan.pw/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/WordPress/%E8%87%AA%E5%8A%A8%E4%BB%8E%E5%85%B6%E5%AE%83%E7%AB%99%E7%82%B9RSS%E6%8A%93%E5%8F%96%E6%96%87%E7%AB%A0/</url>
      <content type="html"><![CDATA[<p>代码基本原理，新建一个自定义分类法“shot”，自动从另一个站点的RSS抓取文章，放在一个数组中，再用这个数组创建“shot”文章，并为文章添加自定义栏目image和link_url，方便调用缩略图和原文链接。<br><a id="more"></a></p>
<p>将下面代码添加到当前主题functions.php中即可。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="comment">/* Post Type</span></span><br><span class="line"><span class="comment">   ------------------------------------------------------------------------------------ */</span></span><br><span class="line">add_action( <span class="string">'init'</span>, <span class="string">'register_cpt_shot'</span> );</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">register_cpt_shot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $labels = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'name'</span> =&gt; _x( <span class="string">'Dribble Shots'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'singular_name'</span> =&gt; _x( <span class="string">'Dribbble Shot'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'add_new'</span> =&gt; _x( <span class="string">'Add New'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'add_new_item'</span> =&gt; _x( <span class="string">'Add New Dribbble Shot'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'edit_item'</span> =&gt; _x( <span class="string">'Edit Dribbble Shot'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'new_item'</span> =&gt; _x( <span class="string">'New Dribbble Shot'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'view_item'</span> =&gt; _x( <span class="string">'View Dribbble Shot'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'search_items'</span> =&gt; _x( <span class="string">'Search Dribble Shots'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'not_found'</span> =&gt; _x( <span class="string">'No dribble shots found'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'not_found_in_trash'</span> =&gt; _x( <span class="string">'No dribble shots found in Trash'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'parent_item_colon'</span> =&gt; _x( <span class="string">'Parent Dribbble Shot:'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">        <span class="string">'menu_name'</span> =&gt; _x( <span class="string">'Dribble Shots'</span>, <span class="string">'shot'</span> ),</span><br><span class="line">    );</span><br><span class="line">    $args = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'labels'</span> =&gt; $labels,</span><br><span class="line">        <span class="string">'hierarchical'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">        <span class="string">'supports'</span> =&gt; <span class="keyword">array</span>( <span class="string">'title'</span>, <span class="string">'custom-fields'</span> ),</span><br><span class="line">        <span class="string">'public'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'show_ui'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'show_in_menu'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'show_in_nav_menus'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">        <span class="string">'publicly_queryable'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'exclude_from_search'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">        <span class="string">'has_archive'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'query_var'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'can_export'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'rewrite'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line">        <span class="string">'capability_type'</span> =&gt; <span class="string">'post'</span></span><br><span class="line">    );</span><br><span class="line">    register_post_type( <span class="string">'shot'</span>, $args );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Import Shots via RSS</span></span><br><span class="line"><span class="comment">   ------------------------------------------------------------------------------------ */</span></span><br><span class="line"><span class="comment">// grab the image src from teh description</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_image</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">    preg_match_all(<span class="string">'/&lt;img[^&gt;]+&gt;/i'</span>,$string, $result);</span><br><span class="line">    $img = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">foreach</span>( $result[<span class="number">0</span>] <span class="keyword">as</span> $img_tag)</span><br><span class="line">    &#123;</span><br><span class="line">        preg_match_all(<span class="string">'/(src)=("[^"]*")/i'</span>,$img_tag, $img[$img_tag]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> trim($img[$img_tag][<span class="number">2</span>][<span class="number">0</span>], <span class="string">'"'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// create an array of the feed items</span></span><br><span class="line"><span class="keyword">include_once</span>(ABSPATH . WPINC . <span class="string">'/feed.php'</span>);</span><br><span class="line">$feed = fetch_feed(<span class="string">'http://dribbble.com/tammyhart/shots.rss'</span>);</span><br><span class="line">$feed = $feed-&gt;get_items(<span class="number">0</span>);</span><br><span class="line">$shots = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span> ( $feed <span class="keyword">as</span> $item ) :</span><br><span class="line">$shots[$item-&gt;get_date(<span class="string">'Ymd'</span>)] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'id'</span>    =&gt; $item-&gt;get_date(<span class="string">'Ymd'</span>),</span><br><span class="line">    <span class="string">'url'</span>   =&gt; esc_url( $item-&gt;get_permalink() ),</span><br><span class="line">    <span class="string">'date'</span>  =&gt; $item-&gt;get_date(<span class="string">'Y-m-d H:i:s'</span>),</span><br><span class="line">    <span class="string">'title'</span> =&gt; esc_html( $item-&gt;get_title() ),</span><br><span class="line">    <span class="string">'image'</span> =&gt; get_image($item-&gt;get_description())</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">endforeach</span>;</span><br><span class="line"><span class="comment">// create posts from our array</span></span><br><span class="line"><span class="keyword">foreach</span> ($shots <span class="keyword">as</span> $shot) &#123;</span><br><span class="line">    $shot_post = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'post_type'</span>     =&gt; <span class="string">'shot'</span>,</span><br><span class="line">        <span class="string">'post_status'</span>   =&gt; <span class="string">'publish'</span>,</span><br><span class="line">        <span class="string">'post_author'</span>   =&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="string">'post_title'</span>    =&gt; $shot[<span class="string">'title'</span>],</span><br><span class="line">        <span class="string">'post_date'</span>     =&gt; $shot[<span class="string">'date'</span>]</span><br><span class="line">        );</span><br><span class="line">    $shot_post_meta = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'link_url'</span>  =&gt; $shot[<span class="string">'url'</span>],</span><br><span class="line">        <span class="string">'image'</span>     =&gt; $shot[<span class="string">'image'</span>]</span><br><span class="line">        );</span><br><span class="line">    $posts = get_posts(</span><br><span class="line">        <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'post_type'</span> =&gt; <span class="string">'shot'</span>,</span><br><span class="line">            <span class="string">'meta_key'</span>  =&gt; <span class="string">'link_url'</span>,</span><br><span class="line">            <span class="string">'meta_value'</span>=&gt; $shot_post_meta[<span class="string">'link_url'</span>]</span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">    <span class="keyword">if</span> (count($posts) == <span class="number">0</span>) &#123;</span><br><span class="line">        $post_id = wp_insert_post($shot_post);</span><br><span class="line">        add_post_meta($post_id, <span class="string">'link_url'</span>, $shot_post_meta[<span class="string">'link_url'</span>], <span class="keyword">true</span>);</span><br><span class="line">        add_post_meta($post_id, <span class="string">'image'</span>, $shot_post_meta[<span class="string">'image'</span>], <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改第66行的”<a href="http://dribbble.com/tammyhart/shots.rss“为准备抓取文章站点的RSS地址，还可以修改第80行后的”shot“为你所用主题自定义分类法名称，抓取的文章会自动添加到该分类法中。" target="_blank" rel="noopener">http://dribbble.com/tammyhart/shots.rss“为准备抓取文章站点的RSS地址，还可以修改第80行后的”shot“为你所用主题自定义分类法名称，抓取的文章会自动添加到该分类法中。</a><br>上述代码中并没有抓取文章内容的功能，仅供参考学习之用。</p>
]]></content>
      
        <categories>
            
            <category> 技术分享 </category>
            
            <category> WordPress </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[热烈庆祝江南品味正式上线！]]></title>
      <url>https://github.jiangnan.pw/%E4%BD%9C%E5%93%81%E5%B1%95%E7%A4%BA/%E7%83%AD%E7%83%88%E5%BA%86%E7%A5%9D%E6%B1%9F%E5%8D%97%E5%93%81%E5%91%B3%E6%AD%A3%E5%BC%8F%E4%B8%8A%E7%BA%BF%EF%BC%81/</url>
      <content type="html"><![CDATA[<p>最近，本地搭建的Web系统遭遇黑客攻击，积累了三年的代码资源都被植入了恶意代码。<br><!--excerpt--></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><blockquote>
<p>最近，本地搭建的Web系统遭遇黑客攻击，积累了三年的代码资源都被植入了恶意代码。经过了两天的努力奋战挽救回来了所有的代码。但是保加利亚的黑客不断的扫描我的IP，致使我的电脑CPU一度达到80℃~90℃，无奈之下展示关闭服务器。</p>
</blockquote>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><blockquote>
<p>目前转投HEXO，Github门下开始技术博客的更新，今天发布的只是一个测试文章，因为MarkDown的语法还不熟悉只能边学边写希望大家谅解。最后热烈庆祝<strong>江南品味</strong>正式上线！</p>
</blockquote>
<h3 id="测试自动部署继续测试"><a href="#测试自动部署继续测试" class="headerlink" title="测试自动部署继续测试^^^^^"></a>测试自动部署继续测试^^^^^</h3>]]></content>
      
        <categories>
            
            <category> 作品展示 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 江南品味 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
